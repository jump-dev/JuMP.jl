<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tolerances and numerical issues · JuMP</title><meta name="title" content="Tolerances and numerical issues · JuMP"/><meta property="og:title" content="Tolerances and numerical issues · JuMP"/><meta property="twitter:title" content="Tolerances and numerical issues · JuMP"/><meta name="description" content="Documentation for JuMP."/><meta property="og:description" content="Documentation for JuMP."/><meta property="twitter:description" content="Documentation for JuMP."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-0RZ8X3D3D0"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-0RZ8X3D3D0', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/extra_styles.css" rel="stylesheet" type="text/css"/><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="JuMP logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="JuMP logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../should_i_use/">Should you use JuMP?</a></li><li><a class="tocitem" href="../../../installation/">Installation Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><a class="tocitem" href="../getting_started_with_julia/">Getting started with Julia</a></li><li><a class="tocitem" href="../getting_started_with_JuMP/">Getting started with JuMP</a></li><li><a class="tocitem" href="../getting_started_with_sets_and_indexing/">Getting started with sets and indexing</a></li><li><a class="tocitem" href="../getting_started_with_data_and_plotting/">Getting started with data and plotting</a></li><li><a class="tocitem" href="../debugging/">Debugging</a></li><li class="is-active"><a class="tocitem" href>Tolerances and numerical issues</a><ul class="internal"><li><a class="tocitem" href="#Required-packages"><span>Required packages</span></a></li><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Primal-feasibility"><span>Primal feasibility</span></a></li><li><a class="tocitem" href="#Integrality"><span>Integrality</span></a></li><li><a class="tocitem" href="#Contradictory-results"><span>Contradictory results</span></a></li><li><a class="tocitem" href="#Problem-scaling"><span>Problem scaling</span></a></li></ul></li><li><a class="tocitem" href="../design_patterns_for_larger_models/">Design patterns for larger models</a></li><li><a class="tocitem" href="../performance_tips/">Performance tips</a></li><li><a class="tocitem" href="../sum_if/">Performance problems with sum-if formulations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Transitioning</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../transitioning/transitioning_from_matlab/">Transitioning from MATLAB</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Linear programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../linear/introduction/">Introduction</a></li><li><a class="tocitem" href="../../linear/knapsack/">The knapsack problem example</a></li><li><a class="tocitem" href="../../linear/diet/">The diet problem</a></li><li><a class="tocitem" href="../../linear/cannery/">The cannery problem</a></li><li><a class="tocitem" href="../../linear/factory_schedule/">The factory schedule example</a></li><li><a class="tocitem" href="../../linear/multi/">The multi-commodity flow problem</a></li><li><a class="tocitem" href="../../linear/multi_commodity_network/">The network multi-commodity flow problem</a></li><li><a class="tocitem" href="../../linear/tips_and_tricks/">Tips and tricks</a></li><li><a class="tocitem" href="../../linear/piecewise_linear/">Approximating nonlinear functions</a></li><li><a class="tocitem" href="../../linear/facility_location/">The facility location problem</a></li><li><a class="tocitem" href="../../linear/finance/">Financial modeling problems</a></li><li><a class="tocitem" href="../../linear/geographic_clustering/">Geographical clustering</a></li><li><a class="tocitem" href="../../linear/network_flows/">Network flow problems</a></li><li><a class="tocitem" href="../../linear/transp/">The transportation problem</a></li><li><a class="tocitem" href="../../linear/multi_objective_knapsack/">Multi-objective knapsack</a></li><li><a class="tocitem" href="../../linear/multi_objective_examples/">Simple multi-objective examples</a></li><li><a class="tocitem" href="../../linear/sudoku/">Sudoku</a></li><li><a class="tocitem" href="../../linear/n-queens/">N-Queens</a></li><li><a class="tocitem" href="../../linear/constraint_programming/">Constraint programming</a></li><li><a class="tocitem" href="../../linear/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../linear/lp_sensitivity/">Sensitivity analysis of a linear program</a></li><li><a class="tocitem" href="../../linear/basis/">Basis matrices</a></li><li><a class="tocitem" href="../../linear/mip_duality/">Computing the duals of a mixed-integer program</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Nonlinear programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../nonlinear/introduction/">Introduction</a></li><li><a class="tocitem" href="../../nonlinear/simple_examples/">Simple examples</a></li><li><a class="tocitem" href="../../nonlinear/tips_and_tricks/">User-defined operators with vector outputs</a></li><li><a class="tocitem" href="../../nonlinear/operator_ad/">Automatic differentiation of user-defined operators</a></li><li><a class="tocitem" href="../../nonlinear/user_defined_hessians/">User-defined Hessians</a></li><li><a class="tocitem" href="../../nonlinear/nested_problems/">Nested optimization problems</a></li><li><a class="tocitem" href="../../nonlinear/querying_hessians/">Computing Hessians</a></li><li><a class="tocitem" href="../../nonlinear/complementarity/">Example: mixed complementarity problems</a></li><li><a class="tocitem" href="../../nonlinear/classifiers/">Example: classification problems</a></li><li><a class="tocitem" href="../../nonlinear/portfolio/">Example: portfolio optimization</a></li><li><a class="tocitem" href="../../nonlinear/rocket_control/">Example: nonlinear optimal control of a rocket</a></li><li><a class="tocitem" href="../../nonlinear/space_shuttle_reentry_trajectory/">Example: optimal control for a Space Shuttle reentry trajectory</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Conic programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../conic/introduction/">Introduction</a></li><li><a class="tocitem" href="../../conic/tips_and_tricks/">Modeling with cones</a></li><li><a class="tocitem" href="../../conic/dualization/">Dualization</a></li><li><a class="tocitem" href="../../conic/arbitrary_precision/">Arbitrary precision arithmetic</a></li><li><a class="tocitem" href="../../conic/start_values/">Primal and dual warm-starts</a></li><li><a class="tocitem" href="../../conic/simple_examples/">Simple semidefinite programming examples</a></li><li><a class="tocitem" href="../../conic/logistic_regression/">Example: logistic regression</a></li><li><a class="tocitem" href="../../conic/experiment_design/">Example: experiment design</a></li><li><a class="tocitem" href="../../conic/min_ellipse/">Example: minimal ellipses</a></li><li><a class="tocitem" href="../../conic/ellipse_approx/">Example: ellipsoid approximation</a></li><li><a class="tocitem" href="../../conic/quantum_discrimination/">Example: quantum state discrimination</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../algorithms/benders_decomposition/">Benders decomposition</a></li><li><a class="tocitem" href="../../algorithms/cutting_stock_column_generation/">Column generation</a></li><li><a class="tocitem" href="../../algorithms/tsp_lazy_constraints/">Traveling Salesperson Problem</a></li><li><a class="tocitem" href="../../algorithms/rolling_horizon/">Rolling horizon problems</a></li><li><a class="tocitem" href="../../algorithms/parallelism/">Parallelism</a></li><li><a class="tocitem" href="../../algorithms/pdhg/">Writing a solver interface</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Applications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../applications/power_systems/">Power Systems</a></li><li><a class="tocitem" href="../../applications/optimal_power_flow/">Optimal power flow</a></li><li><a class="tocitem" href="../../applications/web_app/">Serving web apps</a></li><li><a class="tocitem" href="../../applications/two_stage_stochastic/">Two-stage stochastic programs</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../manual/models/">Models</a></li><li><a class="tocitem" href="../../../manual/variables/">Variables</a></li><li><a class="tocitem" href="../../../manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../manual/expressions/">Expressions</a></li><li><a class="tocitem" href="../../../manual/objective/">Objectives</a></li><li><a class="tocitem" href="../../../manual/containers/">Containers</a></li><li><a class="tocitem" href="../../../manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../manual/callbacks/">Solver-independent Callbacks</a></li><li><a class="tocitem" href="../../../manual/complex/">Complex number support</a></li><li><a class="tocitem" href="../../../manual/nonlinear/">Nonlinear Modeling</a></li><li><a class="tocitem" href="../../../manual/nlp/">Nonlinear Modeling (Legacy)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/JuMP/">JuMP</a></li><li><a class="tocitem" href="../../../api/JuMP.Containers/">JuMP.Containers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Background Information</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../background/algebraic_modeling_languages/">Algebraic modeling languages</a></li><li><a class="tocitem" href="../../../background/bibliography/">Bibliography</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../developers/contributing/">Contributing</a></li><li><a class="tocitem" href="../../../developers/extensions/">Extensions</a></li><li><a class="tocitem" href="../../../developers/custom_solver_binaries/">Custom binaries</a></li><li><a class="tocitem" href="../../../developers/style/">Style Guide</a></li><li><a class="tocitem" href="../../../developers/roadmap/">Roadmap</a></li><li><a class="tocitem" href="../../../developers/checklists/">Checklists</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../packages/solvers/">Introduction</a></li><li><a class="tocitem" href="../../../packages/AmplNLWriter/">jump-dev/AmplNLWriter.jl</a></li><li><a class="tocitem" href="../../../packages/BARON/">jump-dev/BARON.jl</a></li><li><a class="tocitem" href="../../../packages/CPLEX/">jump-dev/CPLEX.jl</a></li><li><a class="tocitem" href="../../../packages/CSDP/">jump-dev/CSDP.jl</a></li><li><a class="tocitem" href="../../../packages/Cbc/">jump-dev/Cbc.jl</a></li><li><a class="tocitem" href="../../../packages/Clp/">jump-dev/Clp.jl</a></li><li><a class="tocitem" href="../../../packages/DSDP/">jump-dev/DSDP.jl</a></li><li><a class="tocitem" href="../../../packages/Dualization/">jump-dev/Dualization.jl</a></li><li><a class="tocitem" href="../../../packages/ECOS/">jump-dev/ECOS.jl</a></li><li><a class="tocitem" href="../../../packages/GLPK/">jump-dev/GLPK.jl</a></li><li><a class="tocitem" href="../../../packages/Gurobi/">jump-dev/Gurobi.jl</a></li><li><a class="tocitem" href="../../../packages/HiGHS/">jump-dev/HiGHS.jl</a></li><li><a class="tocitem" href="../../../packages/Hypatia/">jump-dev/Hypatia.jl</a></li><li><a class="tocitem" href="../../../packages/Ipopt/">jump-dev/Ipopt.jl</a></li><li><a class="tocitem" href="../../../packages/KNITRO/">jump-dev/KNITRO.jl</a></li><li><a class="tocitem" href="../../../packages/MiniZinc/">jump-dev/MiniZinc.jl</a></li><li><a class="tocitem" href="../../../packages/MosekTools/">jump-dev/MosekTools.jl</a></li><li><a class="tocitem" href="../../../packages/MultiObjectiveAlgorithms/">jump-dev/MultiObjectiveAlgorithms.jl</a></li><li><a class="tocitem" href="../../../packages/NEOSServer/">jump-dev/NEOSServer.jl</a></li><li><a class="tocitem" href="../../../packages/NLopt/">jump-dev/NLopt.jl</a></li><li><a class="tocitem" href="../../../packages/Pajarito/">jump-dev/Pajarito.jl</a></li><li><a class="tocitem" href="../../../packages/Pavito/">jump-dev/Pavito.jl</a></li><li><a class="tocitem" href="../../../packages/SCS/">jump-dev/SCS.jl</a></li><li><a class="tocitem" href="../../../packages/SDPA/">jump-dev/SDPA.jl</a></li><li><a class="tocitem" href="../../../packages/SDPLR/">jump-dev/SDPLR.jl</a></li><li><a class="tocitem" href="../../../packages/SDPNAL/">jump-dev/SDPNAL.jl</a></li><li><a class="tocitem" href="../../../packages/SDPT3/">jump-dev/SDPT3.jl</a></li><li><a class="tocitem" href="../../../packages/SeDuMi/">jump-dev/SeDuMi.jl</a></li><li><a class="tocitem" href="../../../packages/Xpress/">jump-dev/Xpress.jl</a></li><li><a class="tocitem" href="../../../packages/COPT/">COPT-Public/COPT.jl</a></li><li><a class="tocitem" href="../../../packages/GAMS/">GAMS-dev/GAMS.jl</a></li><li><a class="tocitem" href="../../../packages/Manopt/">JuliaManifolds/Manopt.jl</a></li><li><a class="tocitem" href="../../../packages/Optim/">JuliaNLSolvers/Optim.jl</a></li><li><a class="tocitem" href="../../../packages/CDDLib/">JuliaPolyhedra/CDDLib.jl</a></li><li><a class="tocitem" href="../../../packages/Percival/">JuliaSmoothOptimizers/Percival.jl</a></li><li><a class="tocitem" href="../../../packages/MAiNGO/">MAiNGO-github/MAiNGO.jl</a></li><li><a class="tocitem" href="../../../packages/MadNLP/">MadNLP/MadNLP.jl</a></li><li><a class="tocitem" href="../../../packages/EAGO/">PSORLab/EAGO.jl</a></li><li><a class="tocitem" href="../../../packages/PATHSolver/">chkwon/PATHSolver.jl</a></li><li><a class="tocitem" href="../../../packages/DAQP/">darnstrom/DAQP.jl</a></li><li><a class="tocitem" href="../../../packages/Tulip/">ds4dm/Tulip.jl</a></li><li><a class="tocitem" href="../../../packages/Loraine/">kocvara/Loraine.jl</a></li><li><a class="tocitem" href="../../../packages/Alpine/">lanl-ansi/Alpine.jl</a></li><li><a class="tocitem" href="../../../packages/Juniper/">lanl-ansi/Juniper.jl</a></li><li><a class="tocitem" href="../../../packages/ProxSDP/">mariohsouto/ProxSDP.jl</a></li><li><a class="tocitem" href="../../../packages/OSQP/">osqp/OSQP.jl</a></li><li><a class="tocitem" href="../../../packages/CDCS/">oxfordcontrol/CDCS.jl</a></li><li><a class="tocitem" href="../../../packages/COSMO/">oxfordcontrol/COSMO.jl</a></li><li><a class="tocitem" href="../../../packages/Clarabel/">oxfordcontrol/Clarabel.jl</a></li><li><a class="tocitem" href="../../../packages/SCIP/">scipopt/SCIP.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../extensions/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../packages/DiffOpt/">jump-dev/DiffOpt.jl</a></li><li><a class="tocitem" href="../../../packages/ParametricOptInterface/">jump-dev/ParametricOptInterface.jl</a></li><li><a class="tocitem" href="../../../packages/PiecewiseLinearOpt/">jump-dev/PiecewiseLinearOpt.jl</a></li><li><a class="tocitem" href="../../../packages/PolyJuMP/">jump-dev/PolyJuMP.jl</a></li><li><a class="tocitem" href="../../../packages/SumOfSquares/">jump-dev/SumOfSquares.jl</a></li><li><a class="tocitem" href="../../../packages/DisjunctiveProgramming/">hdavid16/DisjunctiveProgramming.jl</a></li><li><a class="tocitem" href="../../../packages/InfiniteOpt/">infiniteopt/InfiniteOpt.jl</a></li><li><a class="tocitem" href="../../../packages/BilevelJuMP/">joaquimg/BilevelJuMP.jl</a></li><li><a class="tocitem" href="../../../packages/SDDP/">odow/SDDP.jl</a></li><li><a class="tocitem" href="../../../packages/Plasmo/">plasmo-dev/Plasmo.jl</a></li><li><a class="tocitem" href="../../../extensions/DimensionalData/">rafaqz/DimensionalData.jl</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">MathOptInterface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-9-1" type="checkbox"/><label class="tocitem" for="menuitem-9-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/">Introduction</a></li><li><a class="tocitem" href="../../../moi/background/motivation/">Motivation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-2" type="checkbox"/><label class="tocitem" for="menuitem-9-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/tutorials/example/">Solving a problem using MathOptInterface</a></li><li><a class="tocitem" href="../../../moi/tutorials/implementing/">Implementing a solver interface</a></li><li><a class="tocitem" href="../../../moi/tutorials/mathprogbase/">Transitioning from MathProgBase</a></li><li><a class="tocitem" href="../../../moi/tutorials/bridging_constraint/">Implementing a constraint bridge</a></li><li><a class="tocitem" href="../../../moi/tutorials/manipulating_expressions/">Manipulating expressions</a></li><li><a class="tocitem" href="../../../moi/tutorials/latency/">Latency</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-3" type="checkbox"/><label class="tocitem" for="menuitem-9-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/manual/standard_form/">Standard form problem</a></li><li><a class="tocitem" href="../../../moi/manual/models/">Models</a></li><li><a class="tocitem" href="../../../moi/manual/variables/">Variables</a></li><li><a class="tocitem" href="../../../moi/manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../moi/manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../moi/manual/modification/">Problem modification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-4" type="checkbox"/><label class="tocitem" for="menuitem-9-4"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/background/duality/">Duality</a></li><li><a class="tocitem" href="../../../moi/background/infeasibility_certificates/">Infeasibility certificates</a></li><li><a class="tocitem" href="../../../moi/background/naming_conventions/">Naming conventions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-5" type="checkbox"/><label class="tocitem" for="menuitem-9-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/reference/standard_form/">Standard form</a></li><li><a class="tocitem" href="../../../moi/reference/models/">Models</a></li><li><a class="tocitem" href="../../../moi/reference/variables/">Variables</a></li><li><a class="tocitem" href="../../../moi/reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../moi/reference/modification/">Modifications</a></li><li><a class="tocitem" href="../../../moi/reference/nonlinear/">Nonlinear programming</a></li><li><a class="tocitem" href="../../../moi/reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../../moi/reference/errors/">Errors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-6" type="checkbox"/><label class="tocitem" for="menuitem-9-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-9-6-1" type="checkbox"/><label class="tocitem" for="menuitem-9-6-1"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/submodules/Benchmarks/overview/">Overview</a></li><li><a class="tocitem" href="../../../moi/submodules/Benchmarks/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-6-2" type="checkbox"/><label class="tocitem" for="menuitem-9-6-2"><span class="docs-label">Bridges</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/submodules/Bridges/overview/">Overview</a></li><li><a class="tocitem" href="../../../moi/submodules/Bridges/implementation/">Implementation</a></li><li><a class="tocitem" href="../../../moi/submodules/Bridges/list_of_bridges/">List of bridges</a></li><li><a class="tocitem" href="../../../moi/submodules/Bridges/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-6-3" type="checkbox"/><label class="tocitem" for="menuitem-9-6-3"><span class="docs-label">FileFormats</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/submodules/FileFormats/overview/">Overview</a></li><li><a class="tocitem" href="../../../moi/submodules/FileFormats/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-6-4" type="checkbox"/><label class="tocitem" for="menuitem-9-6-4"><span class="docs-label">Nonlinear</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/submodules/Nonlinear/overview/">Overview</a></li><li><a class="tocitem" href="../../../moi/submodules/Nonlinear/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-6-5" type="checkbox"/><label class="tocitem" for="menuitem-9-6-5"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/submodules/Utilities/overview/">Overview</a></li><li><a class="tocitem" href="../../../moi/submodules/Utilities/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-6-6" type="checkbox"/><label class="tocitem" for="menuitem-9-6-6"><span class="docs-label">Test</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/submodules/Test/overview/">Overview</a></li><li><a class="tocitem" href="../../../moi/submodules/Test/reference/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-9-7" type="checkbox"/><label class="tocitem" for="menuitem-9-7"><span class="docs-label">Developer Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../moi/developer/checklists/">Checklists</a></li></ul></li><li><a class="tocitem" href="../../../moi/release_notes/">Release notes</a></li></ul></li><li><a class="tocitem" href="../../../release_notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Getting started</a></li><li class="is-active"><a href>Tolerances and numerical issues</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tolerances and numerical issues</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jump-dev/JuMP.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jump-dev/JuMP.jl/blob/master/docs/src/tutorials/getting_started/tolerances.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tolerances-and-numerical-issues"><a class="docs-heading-anchor" href="#Tolerances-and-numerical-issues">Tolerances and numerical issues</a><a id="Tolerances-and-numerical-issues-1"></a><a class="docs-heading-anchor-permalink" href="#Tolerances-and-numerical-issues" title="Permalink"></a></h1><p><em>This tutorial was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em> <a href="../tolerances.jl"><em>Download the source as a <code>.jl</code> file</em></a>.</p><p>Optimization solvers can seem like magic black boxes that take in an algebraic formulation of a problem and return a solution. It is tempting to treat their solutions at face value, since we often have little ability to verify that the solution is in fact optimal. However, like all numerical algorithms that use floating point arithmetic, optimization solvers use tolerances to check whether a solution satisfies the constraints. In the best case, the solution satisfies the original constraints to <a href="https://en.wikipedia.org/wiki/Machine_epsilon">machine precision</a>. In most cases, the solution satisfies the constraints to some very small tolerance that has no noticeable impact on the quality of the optimal solution. In the worst case, the solver can return a &quot;wrong&quot; solution, or fail to find one even if it exists. (In the last case, the solution is wrong only in the sense of user expectation. It will satisfy the solution to the tolerances that are provided.)</p><p>The purpose of this tutorial is to explain the various types of tolerances that are used in optimization solvers and what you can reasonably expect from a solution.</p><p>There are a few sources of additional information:</p><ul><li>Ambros Gleixner has an excellent YouTube talk <a href="https://youtu.be/rKcdF4Fgl-g?feature=shared">Numerics in LP &amp; MIP Solvers</a>.</li><li>Gurobi has a series of articles in their documentation called <a href="https://www.gurobi.com/documentation/current/refman/guidelines_for_numerical_i.html">Guidelines for Numerical Issues</a></li></ul><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This tutorial is more advanced than the other &quot;Getting started&quot; tutorials. It&#39;s in the &quot;Getting started&quot; section to give you an early preview of how tolerances affect JuMP models. However, if you are new to JuMP, you may want to briefly skim the tutorial, and come back to it once you have written a few JuMP models.</p></div></div><h2 id="Required-packages"><a class="docs-heading-anchor" href="#Required-packages">Required packages</a><a id="Required-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Required-packages" title="Permalink"></a></h2><p>This tutorial uses the following packages:</p><pre><code class="language-julia hljs">using JuMP
import HiGHS
import SCS</code></pre><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Optimization solvers use tolerances to check the feasibility of constraints.</p><p>There are four main types of tolerances:</p><ol><li>primal feasibility: controls how feasibility of the primal solution is measured</li><li>dual feasibility: controls how feasibility of the dual solution is measured</li><li>integrality: controls how feasibility of the binary and integer variables are measured</li><li>optimality: controls how close the primal and dual solutions must be.</li></ol><p>Solvers may use absolute tolerances, relative tolerances, or some mixture of both. The definition and default value of each tolerance is solver-dependent.</p><p>The dual feasibility tolerance is much the same as the primal feasibility tolerance, only that operates on the space of dual solutions instead of the primal. HiGHS has <code>dual_feasibility_tolerance</code>, but some solvers have only a single feasibility tolerance that uses the same value for both.</p><p>The optimality tolerance is a more technical tolerance that is used to test the equivalence of the primal and dual objectives in the KKT system if you are solving a continuous problem via interior point. HiGHS has <code>ipm_optimality_tolerance</code>, but some solvers will not have such a tolerance. Note that the optimality tolerance is different to the relative MIP gap that controls early termination of a MIP solution during branch-and-bound.</p><p>Because the dual and optimality tolerances are less used, this tutorial focuses on the primal feasibility and integrality tolerances.</p><h2 id="Primal-feasibility"><a class="docs-heading-anchor" href="#Primal-feasibility">Primal feasibility</a><a id="Primal-feasibility-1"></a><a class="docs-heading-anchor-permalink" href="#Primal-feasibility" title="Permalink"></a></h2><p>The primal feasibility tolerance controls how primal constraints are evaluated. For example, the constraint <span>$2x = 1$</span> is actually implemented as <span>$|2x - 1| \le \varepsilon$</span>, where <span>$\varepsilon$</span> is a small solver-dependent primal feasibility tolerance that is typically on the order of <code>1e-8</code>.</p><p>Here&#39;s an example in practice. This model should be infeasible, since <code>x</code> must be non-negative, but there is also an equality constraint that <code>x</code> is equal to a small negative number. Yet when we solve this problem, we get:</p><pre><code class="language-julia hljs">model = Model(HiGHS.Optimizer)
set_silent(model)
@variable(model, x &gt;= 0)
@constraint(model, x == -1e-8)
optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">value(x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>In other words, HiGHS thinks that the solution <code>x = 0</code> satisfies the constraint <code>x == -1e-8</code>. The value of <span>$\varepsilon$</span> in HiGHS is controlled by the <code>primal_feasibility_tolerance</code> option. If we set this to a smaller value, HiGHS will now correctly deduce that the problem is infeasible:</p><pre><code class="language-julia hljs">set_attribute(model, &quot;primal_feasibility_tolerance&quot;, 1e-10)
optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><h3 id="Realistic-example"><a class="docs-heading-anchor" href="#Realistic-example">Realistic example</a><a id="Realistic-example-1"></a><a class="docs-heading-anchor-permalink" href="#Realistic-example" title="Permalink"></a></h3><p>Here&#39;s a more realistic example, which was reported in the <a href="https://github.com/jump-dev/SCS.jl/issues/297">SCS.jl</a> repository:</p><pre><code class="language-julia hljs">n, ε = 13, 0.0234
N = 2^n
model = Model(SCS.Optimizer)
@variable(model, x[1:N] &gt;= 0)
@objective(model, Min, x[1])
@constraint(model, sum(x) == 1)
z = [(-1)^((i &amp; (1 &lt;&lt; j)) &gt;&gt; j) for j in 0:n-1, i in 0:N-1]
@constraint(model, z * x .&gt;= 1 - ε)
optimize!(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">------------------------------------------------------------------
	       SCS v3.2.6 - Splitting Conic Solver
	(c) Brendan O&#39;Donoghue, Stanford University, 2012
------------------------------------------------------------------
problem:  variables n: 8192, constraints m: 8206
cones: 	  z: primal zero / dual free vars: 1
	  l: linear vars: 8205
settings: eps_abs: 1.0e-04, eps_rel: 1.0e-04, eps_infeas: 1.0e-07
	  alpha: 1.50, scale: 1.00e-01, adaptive_scale: 1
	  max_iters: 100000, normalize: 1, rho_x: 1.00e-06
	  acceleration_lookback: 10, acceleration_interval: 10
	  compiled with openmp parallelization enabled
lin-sys:  sparse-direct-amd-qdldl
	  nnz(A): 122880, nnz(P): 0
------------------------------------------------------------------
 iter | pri res | dua res |   gap   |   obj   |  scale  | time (s)
------------------------------------------------------------------
     0| 2.00e+01  1.00e+00  2.00e+01 -9.98e+00  1.00e-01  3.39e-02
   100| 6.92e-05  7.92e-05  7.33e-06  2.41e-05  1.00e-01  9.13e-02
------------------------------------------------------------------
status:  solved
timings: total: 9.13e-02s = setup: 3.29e-02s + solve: 5.84e-02s
	 lin-sys: 4.94e-02s, cones: 2.11e-03s, accel: 6.63e-04s
------------------------------------------------------------------
objective = 0.000024
------------------------------------------------------------------</code></pre><p>SCS reports that it solved the problem to optimality:</p><pre><code class="language-julia hljs">is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>and that the solution for <code>x[1]</code> is nearly zero:</p><pre><code class="language-julia hljs">value(x[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.04406873858532e-5</code></pre><p>However, the analytic solution for <code>x[1]</code> is:</p><pre><code class="language-julia hljs">1 - n * ε / 2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.8479</code></pre><p>The answer is very wrong, and there is no indication from the solver that anything untoward happened. What&#39;s going on?</p><p>One useful debugging tool is <a href="../../../api/JuMP/#primal_feasibility_report"><code>primal_feasibility_report</code></a>:</p><pre><code class="language-julia hljs">report = primal_feasibility_report(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 8192 entries:
  x[4236] ≥ 0 =&gt; 1.56101e-5
  x[1526] ≥ 0 =&gt; 2.01984e-5
  x[1421] ≥ 0 =&gt; 1.56101e-5
  x[6732] ≥ 0 =&gt; 1.8669e-5
  x[6863] ≥ 0 =&gt; 2.01984e-5
  x[6956] ≥ 0 =&gt; 2.01984e-5
  x[7055] ≥ 0 =&gt; 2.01984e-5
  x[5494] ≥ 0 =&gt; 2.01984e-5
  x[3008] ≥ 0 =&gt; 2.32572e-5
  x[5849] ≥ 0 =&gt; 1.8669e-5
  x[5692] ≥ 0 =&gt; 2.01984e-5
  x[5900] ≥ 0 =&gt; 1.8669e-5
  x[4330] ≥ 0 =&gt; 1.71395e-5
  x[5199] ≥ 0 =&gt; 1.71395e-5
  x[3391] ≥ 0 =&gt; 2.01984e-5
  x[5685] ≥ 0 =&gt; 1.71395e-5
  x[7298] ≥ 0 =&gt; 1.56101e-5
  x[5436] ≥ 0 =&gt; 2.01984e-5
  x[6650] ≥ 0 =&gt; 2.17278e-5
  ⋮           =&gt; ⋮</code></pre><p><code>report</code> is a dictionary which maps constraints to the violation.  The largest violation is approximately <code>1e-5</code>:</p><pre><code class="language-julia hljs">maximum(values(report))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6.92133754155444e-5</code></pre><p>This makes sense, because the default primal feasibility tolerance for SCS is <code>1e-4</code>.</p><p>Most of the entries are lower bound constraints on the variables. Here are all the variables which violate their lower bound:</p><pre><code class="language-julia hljs">violated_variables = filter(xi -&gt; value(xi) &lt; 0, x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8178-element Vector{VariableRef}:
 x[4]
 x[6]
 x[7]
 x[8]
 x[10]
 x[11]
 x[12]
 x[13]
 x[14]
 x[15]
 ⋮
 x[8184]
 x[8185]
 x[8186]
 x[8187]
 x[8188]
 x[8189]
 x[8190]
 x[8191]
 x[8192]</code></pre><p>The first one is:</p><pre><code class="language-julia hljs">y = first(violated_variables)</code></pre><p class="math-container">\[ x_{4} \]</p><p>It has a primal value of:</p><pre><code class="language-julia hljs">value(y)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-1.1021914231743998e-5</code></pre><p>which matches the value in the feasibility report:</p><pre><code class="language-julia hljs">report[LowerBoundRef(y)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.1021914231743998e-5</code></pre><p>Despite the small primal feasibility tolerance and the small actual violations of the constraints, our optimal solution is very far from the theoretical optimal.</p><p>We can &quot;fix&quot; our model by decreasing <code>eps_abs</code> and <code>eps_rel</code>, which SCS uses to control the absolute and relative feasibility tolerances. Now the solver finds the correct solution:</p><pre><code class="language-julia hljs">set_attribute(model, &quot;eps_abs&quot;, 1e-5)
set_attribute(model, &quot;eps_rel&quot;, 1e-5)
optimize!(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">------------------------------------------------------------------
	       SCS v3.2.6 - Splitting Conic Solver
	(c) Brendan O&#39;Donoghue, Stanford University, 2012
------------------------------------------------------------------
problem:  variables n: 8192, constraints m: 8206
cones: 	  z: primal zero / dual free vars: 1
	  l: linear vars: 8205
settings: eps_abs: 1.0e-05, eps_rel: 1.0e-05, eps_infeas: 1.0e-07
	  alpha: 1.50, scale: 1.00e-01, adaptive_scale: 1
	  max_iters: 100000, normalize: 1, rho_x: 1.00e-06
	  acceleration_lookback: 10, acceleration_interval: 10
	  compiled with openmp parallelization enabled
lin-sys:  sparse-direct-amd-qdldl
	  nnz(A): 122880, nnz(P): 0
------------------------------------------------------------------
 iter | pri res | dua res |   gap   |   obj   |  scale  | time (s)
------------------------------------------------------------------
     0| 2.00e+01  1.00e+00  2.00e+01 -9.98e+00  1.00e-01  3.34e-02
   250| 2.01e-02  2.85e-04  2.00e-02  3.01e-02  3.86e-01  1.81e-01
   500| 3.69e-04  5.93e-04  8.84e-05  8.48e-01  6.13e-01  3.30e-01
   550| 2.66e-06  6.58e-10  1.27e-05  8.48e-01  6.13e-01  3.60e-01
------------------------------------------------------------------
status:  solved
timings: total: 3.60e-01s = setup: 3.23e-02s + solve: 3.28e-01s
	 lin-sys: 2.69e-01s, cones: 1.14e-02s, accel: 5.41e-03s
------------------------------------------------------------------
objective = 0.847906
------------------------------------------------------------------</code></pre><pre><code class="language-julia hljs">@assert is_solved_and_feasible(model)
value(x[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.8479127435814551</code></pre><h3 id="Why-you-shouldn&#39;t-use-a-small-tolerance"><a class="docs-heading-anchor" href="#Why-you-shouldn&#39;t-use-a-small-tolerance">Why you shouldn&#39;t use a small tolerance</a><a id="Why-you-shouldn&#39;t-use-a-small-tolerance-1"></a><a class="docs-heading-anchor-permalink" href="#Why-you-shouldn&#39;t-use-a-small-tolerance" title="Permalink"></a></h3><p>There is no direct relationship between the size of feasibility tolerance and the quality of the solution.</p><p>You might surmise from this section that you should set the tightest feasibility tolerance possible. However, tighter tolerances come at the cost of increased solve time.</p><p>For example, SCS is a first-order solver. This means it uses only local gradient information at update each iteration. SCS took 100 iterations to solve the problem with the default tolerance of <code>1e-4</code>, and 550 iterations to solve the problem with <code>1e-5</code>. SCS may not be able to find a solution to our problem with a tighter tolerance in a reasonable amount of time.</p><h2 id="Integrality"><a class="docs-heading-anchor" href="#Integrality">Integrality</a><a id="Integrality-1"></a><a class="docs-heading-anchor-permalink" href="#Integrality" title="Permalink"></a></h2><p>Integrality tolerances control how the solver decides if a variable satisfies an integrality of binary constraint. The tolerance is typically defined as: <span>$|x - \lfloor x + 0.5 \rfloor | \le \varepsilon$</span>, which you can read as the absolute distance to the nearest integer.</p><p>Here&#39;s a simple example:</p><pre><code class="language-julia hljs">model = Model(HiGHS.Optimizer)
set_silent(model)
@variable(model, x == 1 + 1e-6, Int)
optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>HiGHS found an optimal solution, and the value of <code>x</code> is:</p><pre><code class="language-julia hljs">value(x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.000001</code></pre><p>In other words, HiGHS thinks that the solution <code>x = 1.000001</code> satisfies the constraint that <code>x</code> must be an integer. <a href="../../../api/JuMP/#primal_feasibility_report"><code>primal_feasibility_report</code></a> shows that indeed, the integrality constraint is violated:</p><pre><code class="language-julia hljs">primal_feasibility_report(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 1 entry:
  x integer =&gt; 1.0e-6</code></pre><p>The value of <span>$\varepsilon$</span> in HiGHS is controlled by the <code>mip_feasibility_tolerance</code> option. The default is <code>1e-6</code>. If we set the attribute to a smaller value, HiGHS will now correctly deduce that the problem is infeasible:</p><pre><code class="language-julia hljs">set_attribute(model, &quot;mip_feasibility_tolerance&quot;, 1e-10)
optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><h3 id="Realistic-example-2"><a class="docs-heading-anchor" href="#Realistic-example-2">Realistic example</a><a class="docs-heading-anchor-permalink" href="#Realistic-example-2" title="Permalink"></a></h3><p>Integrality tolerances are particularly important when you have big-M type constraints. Small non-integer values in the integer variables can cause &quot;leakage&quot; flows even when the big-M switch is &quot;off.&quot; Consider this example:</p><pre><code class="language-julia hljs">M = 1e6
model = Model()
@variable(model, x &gt;= 0)
@variable(model, y, Bin)
@constraint(model, x &lt;= M * y)
print(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Feasibility
Subject to
 x - 1000000 y ≤ 0
 x ≥ 0
 y binary</code></pre><p>This model has a feasible solution (to tolerances) of <code>(x, y) = (1, 1e-6)</code>. There can be a non-zero value of <code>x</code> even when <code>y</code> is (approximately) <code>0</code>.</p><pre><code class="language-julia hljs">primal_feasibility_report(model, Dict(x =&gt; 1.0, y =&gt; 1e-6))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 1 entry:
  y binary =&gt; 1.0e-6</code></pre><h3 id="Rounding-the-solution"><a class="docs-heading-anchor" href="#Rounding-the-solution">Rounding the solution</a><a id="Rounding-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Rounding-the-solution" title="Permalink"></a></h3><p>Integrality tolerances are why JuMP does not return <code>Int</code> for <code>value(x)</code> of an integer variable or <code>Bool</code> for <code>value(x)</code> of a binary variable.</p><p>In most cases, it is safe to post-process the solution using <code>y_int = round(Int, value(y))</code>. However, in some cases &quot;fixing&quot; the integrality like this can cause violations in primal feasibility that exceed the primal feasibility tolerance. For example, if we rounded our <code>(x, y) = (1, 1e-6)</code> solution to <code>(x, y) = (1, 0)</code>, then the constraint <code>x &lt;= M * y</code> is now violated by a value of <code>1.0</code>, which is much greater than a typical feasibility tolerance of <code>1e-8</code>.</p><pre><code class="language-julia hljs">primal_feasibility_report(model, Dict(x =&gt; 1.0, y =&gt; 0.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 1 entry:
  x - 1000000 y ≤ 0 =&gt; 1.0</code></pre><h3 id="Why-you-shouldn&#39;t-use-a-small-tolerance-2"><a class="docs-heading-anchor" href="#Why-you-shouldn&#39;t-use-a-small-tolerance-2">Why you shouldn&#39;t use a small tolerance</a><a class="docs-heading-anchor-permalink" href="#Why-you-shouldn&#39;t-use-a-small-tolerance-2" title="Permalink"></a></h3><p>Just like primal feasibility tolerances, using a smaller value for the integrality tolerance can lead to greatly increased solve times.</p><h2 id="Contradictory-results"><a class="docs-heading-anchor" href="#Contradictory-results">Contradictory results</a><a id="Contradictory-results-1"></a><a class="docs-heading-anchor-permalink" href="#Contradictory-results" title="Permalink"></a></h2><p>The distinction between feasible and infeasible can be surprisingly nuanced. Solver A might decide the problem is feasible while solver B might decide it is infeasible. Different algorithms <em>within</em> solver A (like simplex and barrier) may also come to different conclusions. Even changing settings like turning presolve on and off can make a difference.</p><p>Here is an example where HiGHS reports the problem is infeasible, but there exists a feasible (to tolerance) solution:</p><pre><code class="language-julia hljs">model = Model(HiGHS.Optimizer)
set_silent(model)
@variable(model, x &gt;= 0)
@variable(model, y &gt;= 0)
@constraint(model, x + 1e8 * y == -1)
optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>The feasible solution <code>(x, y) = (0.0, -1e-8)</code> has a maximum primal violation of <code>1e-8</code> which is the HiGHS feasibility tolerance:</p><pre><code class="language-julia hljs">primal_feasibility_report(model, Dict(x =&gt; 0.0, y =&gt; -1e-8))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 1 entry:
  y ≥ 0 =&gt; 1.0e-8</code></pre><p>This happens because there are two basic solutions. The first is infeasible at <code>(x, y) = (-1, 0)</code> and the second is feasible <code>(x, y) = (0, -1e-8)</code>. Different algorithms may terminate at either of these bases.</p><p>Another example is a variation on our integrality example, but this time, there are constraints that <code>x &gt;= 1</code> and <code>y &lt;= 0.5</code>:</p><pre><code class="language-julia hljs">M = 1e6
model = Model(HiGHS.Optimizer)
set_silent(model)
@variable(model, x &gt;= 1)
@variable(model, y, Bin)
@constraint(model, y &lt;= 0.5)
@constraint(model, x &lt;= M * y)
optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>HiGHS reports the problem is infeasible, but there is a feasible (to tolerance) solution of:</p><pre><code class="language-julia hljs">primal_feasibility_report(model, Dict(x =&gt; 1.0, y =&gt; 1e-6))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 1 entry:
  y binary =&gt; 1.0e-6</code></pre><p>This happens because the presolve routine deduces that the <code>y &lt;= 0.5</code> constraint forces the binary variable <code>y</code> to take the value <code>0</code>. Substituting the value for <code>y</code> into the last constraint, presolve may also deduce that <code>x &lt;= 0</code>, which violates the bound of <code>x &gt;= 1</code> and so the problem is infeasible.</p><p>We can work around this by providing HiGHS with the feasible starting solution:</p><pre><code class="language-julia hljs">set_start_value(x, 1)
set_start_value(y, 1e-6)</code></pre><p>Now HiGHS will report that the problem is feasible:</p><pre><code class="language-julia hljs">optimize!(model)
is_solved_and_feasible(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h3 id="Contradictory-results-are-not-a-bug-in-the-solver"><a class="docs-heading-anchor" href="#Contradictory-results-are-not-a-bug-in-the-solver">Contradictory results are not a bug in the solver</a><a id="Contradictory-results-are-not-a-bug-in-the-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Contradictory-results-are-not-a-bug-in-the-solver" title="Permalink"></a></h3><p>These contradictory examples are not bugs in the HiGHS solver. They are an expected result of the interaction between the tolerances and the solution algorithm. There will always be models in the gray boundary at the edge of feasibility, for which the question of feasibility is not a clear true or false.</p><h2 id="Problem-scaling"><a class="docs-heading-anchor" href="#Problem-scaling">Problem scaling</a><a id="Problem-scaling-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-scaling" title="Permalink"></a></h2><p>Problem scaling refers to the absolute magnitudes of the data in your problem. The data is any numbers in the objective, the constraints, or the variable bounds.</p><p>We say that a problem is poorly scaled if there are very small (<span>$&lt; 10^{-3}$</span>) or very large (<span>$&gt; 10^6$</span>) coefficients in the problem, or if the ratio of the largest to smallest coefficient is large.</p><p>Numerical issues related to the feasibility tolerances most commonly arise because of poor problem scaling. The next examples assume a primal feasibility tolerance of 1e-8, but actual tolerances may vary from one solver to another.</p><h3 id="Small-magnitudes"><a class="docs-heading-anchor" href="#Small-magnitudes">Small magnitudes</a><a id="Small-magnitudes-1"></a><a class="docs-heading-anchor-permalink" href="#Small-magnitudes" title="Permalink"></a></h3><p>If the problem data is too small, then the feasibility tolerance can be too easily satisfied. For example, consider:</p><pre><code class="language-julia hljs">model = Model()
@variable(model, x)
@constraint(model, 1e-8 * x == 1e-4)</code></pre><p class="math-container">\[ 1.0 \times 10^{-8} x = 0.0001 \]</p><p>This should have the solution that <span>$x = 10^4$</span>, but because the feasibility tolerance of this constraint is <span>$|10^{-4} - 10^{-8} * x| &lt; 10^{-8}$</span>, it actually permits any value of <code>x</code> between 9999 and 10,001, which is a larger range of feasible values than you might have expected.</p><h3 id="Large-magnitudes"><a class="docs-heading-anchor" href="#Large-magnitudes">Large magnitudes</a><a id="Large-magnitudes-1"></a><a class="docs-heading-anchor-permalink" href="#Large-magnitudes" title="Permalink"></a></h3><p>If the problem data is too large, then the feasibility tolerance can be too difficult to satisfy.</p><pre><code class="language-julia hljs">model = Model()
@variable(model, x)
@constraint(model, 1e12 * x == 1e4)</code></pre><p class="math-container">\[ 1000000000000 x = 10000 \]</p><p>This should have the solution that <span>$x = 10^{-8}$</span>, but because the feasibility tolerance of this constraint is <span>$|10^{12}x - 10^{4}| &lt; 10^{-8}$</span>, it actually permits any value of <code>x</code> in <span>$10^{-8} \pm 10^{-20}$</span>, which is a smaller range of feasible values than you might have expected.</p><h3 id="Large-magnitude-ratios"><a class="docs-heading-anchor" href="#Large-magnitude-ratios">Large magnitude ratios</a><a id="Large-magnitude-ratios-1"></a><a class="docs-heading-anchor-permalink" href="#Large-magnitude-ratios" title="Permalink"></a></h3><p>If the ratio of the smallest to the largest magnitude is too large, then the tolerances or small changes in the input data can lead to large changes in the optimal solution. We have already seen an example with the integrality tolerance, but we can exacerbate the behavior by putting a small coefficient on <code>x</code>:</p><pre><code class="language-julia hljs">model = Model()
@variable(model, x &gt;= 0)
@variable(model, y, Bin)
@constraint(model, 1e-6x &lt;= 1e6 * y)</code></pre><p class="math-container">\[ 1.0 \times 10^{-6} x - 1000000 y \leq 0 \]</p><p>This problem has a feasible (to tolerance) solution of:</p><pre><code class="language-julia hljs">primal_feasibility_report(model, Dict(x =&gt; 1_000_000.01, y =&gt; 1e-6))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Float64} with 2 entries:
  y binary                 =&gt; 1.0e-6
  1.0e-6 x - 1000000 y ≤ 0 =&gt; 1.0e-8</code></pre><p>If you intended the constraint to read that if <code>x</code> is non-zero then <code>y = 1</code>, this solution might be unexpected.</p><h3 id="Recommended-values"><a class="docs-heading-anchor" href="#Recommended-values">Recommended values</a><a id="Recommended-values-1"></a><a class="docs-heading-anchor-permalink" href="#Recommended-values" title="Permalink"></a></h3><p>There are no hard rules that you must follow, and the interaction between tolerances, problem scaling, and the solution is problem dependent. You should always check the solution returned by the solver to check it makes sense for your application.</p><p>With that caveat in mind, a general rule of thumb to follow is:</p><p>Try to keep the ratio of the smallest to largest coefficient less than <span>$10^6$</span> in any row and column, and try to keep most values between <span>$10^{-3}$</span> and <span>$10^6$</span>.</p><h3 id="Choosing-the-correct-units"><a class="docs-heading-anchor" href="#Choosing-the-correct-units">Choosing the correct units</a><a id="Choosing-the-correct-units-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-the-correct-units" title="Permalink"></a></h3><p>The best way to fix problem scaling is by changing the units of your variables and constraints. Here&#39;s an example. Suppose we are choosing the level of capacity investment in a new power plant. We can install up to 1 GW of capacity at a cost of <span>$</span>1.78/W, and we have a budget of <span>$</span>200 million.</p><pre><code class="language-julia hljs">model = Model()
@variable(model, 0 &lt;= x_capacity_W &lt;= 10^9)
@constraint(model, 1.78 * x_capacity_W &lt;= 200e6)</code></pre><p class="math-container">\[ 1.78 x\_capacity\_W \leq 200000000 \]</p><p>This constraint violates the recommendations because there are values greater than <span>$10^6$</span>, and the ratio of the coefficients in the constraint is <span>$10^8$</span>.</p><p>One fix is the convert our capacity variable from Watts to Megawatts. This yields:</p><pre><code class="language-julia hljs">model = Model()
@variable(model, 0 &lt;= x_capacity_MW &lt;= 10^3)
@constraint(model, 1.78e6 * x_capacity_MW &lt;= 200e6)</code></pre><p class="math-container">\[ 1780000 x\_capacity\_MW \leq 200000000 \]</p><p>We can improve our model further by dividing the constraint by <span>$10^6$</span> to change the units from dollars to million dollars.</p><pre><code class="language-julia hljs">model = Model()
@variable(model, 0 &lt;= x_capacity_MW &lt;= 10^3)
@constraint(model, 1.78 * x_capacity_MW &lt;= 200)</code></pre><p class="math-container">\[ 1.78 x\_capacity\_MW \leq 200 \]</p><p>This problem is equivalent to the original problem, but it has much better problem scaling.</p><p>As a general rule, to fix problem scaling you must simultaneously scale both variables and constraints. It is usually not sufficient to scale variables or constraints in isolation.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../debugging/">« Debugging</a><a class="docs-footer-nextpage" href="../design_patterns_for_larger_models/">Design patterns for larger models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 21 October 2024 08:21">Monday 21 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
