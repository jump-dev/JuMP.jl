<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Extensions · JuMP</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-44252521-1"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-44252521-1', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/extra_styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="JuMP logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="JuMP logo"/></a><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../should_i_use/">Should I use JuMP?</a></li><li><a class="tocitem" href="../../installation/">Installation Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/getting_started/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/getting_started/getting_started_with_julia/">Getting started with Julia</a></li><li><a class="tocitem" href="../../tutorials/getting_started/getting_started_with_JuMP/">Getting started with JuMP</a></li><li><a class="tocitem" href="../../tutorials/getting_started/getting_started_with_sets_and_indexing/">Getting started with sets and indexing</a></li><li><a class="tocitem" href="../../tutorials/getting_started/getting_started_with_data_and_plotting/">Getting started with data and plotting</a></li><li><a class="tocitem" href="../../tutorials/getting_started/performance_tips/">Performance tips</a></li><li><a class="tocitem" href="../../tutorials/getting_started/design_patterns_for_larger_models/">Design patterns for larger models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/linear/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/linear/tips_and_tricks/">Tips and tricks</a></li><li><a class="tocitem" href="../../tutorials/linear/diet/">The diet problem</a></li><li><a class="tocitem" href="../../tutorials/linear/cannery/">The cannery problem</a></li><li><a class="tocitem" href="../../tutorials/linear/facility_location/">The facility location problem</a></li><li><a class="tocitem" href="../../tutorials/linear/factory_schedule/">The factory schedule example</a></li><li><a class="tocitem" href="../../tutorials/linear/finance/">Financial modeling problems</a></li><li><a class="tocitem" href="../../tutorials/linear/geographic_clustering/">Geographical clustering</a></li><li><a class="tocitem" href="../../tutorials/linear/knapsack/">The knapsack problem</a></li><li><a class="tocitem" href="../../tutorials/linear/multi/">The multi-commodity flow problem</a></li><li><a class="tocitem" href="../../tutorials/linear/n-queens/">N-Queens</a></li><li><a class="tocitem" href="../../tutorials/linear/lp_sensitivity/">Sensitivity analysis of a linear program</a></li><li><a class="tocitem" href="../../tutorials/linear/network_flows/">Network flow problems</a></li><li><a class="tocitem" href="../../tutorials/linear/prod/">The workforce scheduling problem</a></li><li><a class="tocitem" href="../../tutorials/linear/steelT3/">The SteelT3 problem</a></li><li><a class="tocitem" href="../../tutorials/linear/sudoku/">Sudoku</a></li><li><a class="tocitem" href="../../tutorials/linear/transp/">The transportation problem</a></li><li><a class="tocitem" href="../../tutorials/linear/urban_plan/">The urban planning problem</a></li><li><a class="tocitem" href="../../tutorials/linear/callbacks/">Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Nonlinear programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/nonlinear/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/tips_and_tricks/">Tips and tricks</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/portfolio/">Quadratic portfolio optimization</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/qcp/">Quadratically constrained programs</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/space_shuttle_reentry_trajectory/">Optimal control for a Space Shuttle reentry trajectory</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/rocket_control/">Rocket Control</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/rosenbrock/">The Rosenbrock function</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/mle/">Maximum likelihood estimation</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/clnlbeam/">The clnlbeam problem</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/user_defined_hessians/">User-defined Hessians</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/querying_hessians/">Computing Hessians</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Conic programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/conic/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/conic/start_values/">Primal and dual warm-starts</a></li><li><a class="tocitem" href="../../tutorials/conic/tips_and_tricks/">Tips and Tricks</a></li><li><a class="tocitem" href="../../tutorials/conic/logistic_regression/">Logistic regression</a></li><li><a class="tocitem" href="../../tutorials/conic/cluster/">K-means clustering via SDP</a></li><li><a class="tocitem" href="../../tutorials/conic/corr_sdp/">The correlation problem</a></li><li><a class="tocitem" href="../../tutorials/conic/experiment_design/">Experiment design</a></li><li><a class="tocitem" href="../../tutorials/conic/max_cut_sdp/">SDP relaxations: max-cut</a></li><li><a class="tocitem" href="../../tutorials/conic/min_distortion/">The minimum distortion problem</a></li><li><a class="tocitem" href="../../tutorials/conic/min_ellipse/">Minimal ellipses</a></li><li><a class="tocitem" href="../../tutorials/conic/robust_uncertainty/">Robust uncertainty sets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/algorithms/benders_decomposition/">Benders decomposition</a></li><li><a class="tocitem" href="../../tutorials/algorithms/cutting_stock_column_generation/">Column generation</a></li><li><a class="tocitem" href="../../tutorials/algorithms/tsp_lazy_constraints/">Traveling Salesperson Problem</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Applications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/applications/power_systems/">Power Systems</a></li><li><a class="tocitem" href="../../tutorials/applications/web_app/">Serving web apps</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/models/">Models</a></li><li><a class="tocitem" href="../../manual/variables/">Variables</a></li><li><a class="tocitem" href="../../manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../manual/expressions/">Expressions</a></li><li><a class="tocitem" href="../../manual/objective/">Objectives</a></li><li><a class="tocitem" href="../../manual/containers/">Containers</a></li><li><a class="tocitem" href="../../manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../manual/nlp/">Nonlinear Modeling</a></li><li><a class="tocitem" href="../../manual/callbacks/">Solver-independent Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/models/">Models</a></li><li><a class="tocitem" href="../../reference/variables/">Variables</a></li><li><a class="tocitem" href="../../reference/expressions/">Expressions</a></li><li><a class="tocitem" href="../../reference/objectives/">Objectives</a></li><li><a class="tocitem" href="../../reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../reference/containers/">Containers</a></li><li><a class="tocitem" href="../../reference/solutions/">Solutions</a></li><li><a class="tocitem" href="../../reference/nlp/">Nonlinear Modeling</a></li><li><a class="tocitem" href="../../reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference/extensions/">Extensions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Background Information</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../background/algebraic_modeling_languages/">Algebraic modeling languages</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../contributing/">Contributing</a></li><li class="is-active"><a class="tocitem" href>Extensions</a><ul class="internal"><li><a class="tocitem" href="#Compatibility"><span>Compatibility</span></a></li><li><a class="tocitem" href="#Define-a-new-set"><span>Define a new set</span></a></li><li><a class="tocitem" href="#extend_variable_macro"><span>Extend <code>@variable</code></span></a></li><li><a class="tocitem" href="#Extend-[@constraint](@ref)"><span>Extend <code>@constraint</code></span></a></li><li><a class="tocitem" href="#The-extension-dictionary"><span>The extension dictionary</span></a></li><li><a class="tocitem" href="#Defining-new-JuMP-models"><span>Defining new JuMP models</span></a></li><li><a class="tocitem" href="#Set-an-optimize!-hook"><span>Set an <code>optimize!</code> hook</span></a></li><li><a class="tocitem" href="#Creating-new-container-types"><span>Creating new container types</span></a></li><li><a class="tocitem" href="#Performance-tips-for-extensions"><span>Performance tips for extensions</span></a></li></ul></li><li><a class="tocitem" href="../custom_solver_binaries/">Custom binaries</a></li><li><a class="tocitem" href="../style/">Style Guide</a></li><li><a class="tocitem" href="../roadmap/">Roadmap</a></li></ul></li><li><a class="tocitem" href="../../release_notes/">Release notes</a></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">MathOptInterface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/">Introduction</a></li><li><a class="tocitem" href="../../moi/background/motivation/">Motivation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/tutorials/example/">Solving a problem using MathOptInterface</a></li><li><a class="tocitem" href="../../moi/tutorials/implementing/">Implementing a solver interface</a></li><li><a class="tocitem" href="../../moi/tutorials/mathprogbase/">Transitioning from MathProgBase</a></li><li><a class="tocitem" href="../../moi/tutorials/bridging_constraint/">Implementing a constraint bridge</a></li><li><a class="tocitem" href="../../moi/tutorials/manipulating_expressions/">Manipulating expressions</a></li><li><a class="tocitem" href="../../moi/tutorials/latency/">Latency</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/manual/standard_form/">Standard form problem</a></li><li><a class="tocitem" href="../../moi/manual/models/">Models</a></li><li><a class="tocitem" href="../../moi/manual/variables/">Variables</a></li><li><a class="tocitem" href="../../moi/manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../moi/manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../moi/manual/modification/">Problem modification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/background/duality/">Duality</a></li><li><a class="tocitem" href="../../moi/background/infeasibility_certificates/">Infeasibility certificates</a></li><li><a class="tocitem" href="../../moi/background/naming_conventions/">Naming conventions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/reference/standard_form/">Standard form</a></li><li><a class="tocitem" href="../../moi/reference/models/">Models</a></li><li><a class="tocitem" href="../../moi/reference/variables/">Variables</a></li><li><a class="tocitem" href="../../moi/reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../moi/reference/modification/">Modifications</a></li><li><a class="tocitem" href="../../moi/reference/nonlinear/">Nonlinear programming</a></li><li><a class="tocitem" href="../../moi/reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../moi/reference/errors/">Errors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-6-1" type="checkbox"/><label class="tocitem" for="menuitem-8-6-1"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/submodules/Benchmarks/overview/">Overview</a></li><li><a class="tocitem" href="../../moi/submodules/Benchmarks/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-2" type="checkbox"/><label class="tocitem" for="menuitem-8-6-2"><span class="docs-label">Bridges</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/submodules/Bridges/overview/">Overview</a></li><li><a class="tocitem" href="../../moi/submodules/Bridges/list_of_bridges/">List of bridges</a></li><li><a class="tocitem" href="../../moi/submodules/Bridges/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-3" type="checkbox"/><label class="tocitem" for="menuitem-8-6-3"><span class="docs-label">FileFormats</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/submodules/FileFormats/overview/">Overview</a></li><li><a class="tocitem" href="../../moi/submodules/FileFormats/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-4" type="checkbox"/><label class="tocitem" for="menuitem-8-6-4"><span class="docs-label">Nonlinear</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/submodules/Nonlinear/overview/">Overview</a></li><li><a class="tocitem" href="../../moi/submodules/Nonlinear/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-5" type="checkbox"/><label class="tocitem" for="menuitem-8-6-5"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/submodules/Utilities/overview/">Overview</a></li><li><a class="tocitem" href="../../moi/submodules/Utilities/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6-6"><span class="docs-label">Test</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../moi/submodules/Test/overview/">Overview</a></li><li><a class="tocitem" href="../../moi/submodules/Test/reference/">API Reference</a></li></ul></li></ul></li><li><a class="tocitem" href="../../moi/release_notes/">Release notes</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Docs</a></li><li class="is-active"><a href>Extensions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Extensions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jump-dev/JuMP.jl/blob/master/docs/src/developers/extensions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="extensions_manual"><a class="docs-heading-anchor" href="#extensions_manual">Extensions</a><a id="extensions_manual-1"></a><a class="docs-heading-anchor-permalink" href="#extensions_manual" title="Permalink"></a></h1><p>JuMP provides a variety of ways to extend the basic modeling functionality.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This documentation in this section is still a work-in-progress. The best place to look for ideas and help when writing a new JuMP extension are existing JuMP extensions. Examples include:</p><ul><li><a href="https://github.com/joaquimg/BilevelJuMP.jl">BilevelJuMP.jl</a></li><li><a href="https://github.com/atoptima/Coluna.jl">Coluna.jl</a></li><li><a href="https://github.com/infiniteopt/InfiniteOpt.jl">InfiniteOpt.jl</a></li><li><a href="https://github.com/zavalab/Plasmo.jl">Plasmo.jl</a></li><li><a href="https://github.com/jump-dev/PolyJuMP.jl">PolyJuMP.jl</a></li><li><a href="https://github.com/odow/SDDP.jl">SDDP.jl</a></li><li><a href="https://github.com/martinbiel/StochasticPrograms.jl">StochasticPrograms.jl</a></li><li><a href="https://github.com/jump-dev/SumOfSquares.jl">SumOfSquares.jl</a></li><li><a href="https://github.com/vOptSolver/vOptGeneric.jl">vOptGeneric.jl</a></li></ul></div></div><h2 id="Compatibility"><a class="docs-heading-anchor" href="#Compatibility">Compatibility</a><a id="Compatibility-1"></a><a class="docs-heading-anchor-permalink" href="#Compatibility" title="Permalink"></a></h2><p>When writing JuMP extensions, you should carefully consider the compatibility guarantees that JuMP makes. In particular:</p><ul><li>All functions, structs, and constants which do not begin with an underscore (<code>_</code>) are public. These are always safe to use, and they should all have corresponding documentation.</li><li>All identifiers beginning with an underscore (<code>_</code>) are private. These are not safe to use, because they may break in any JuMP release, including patch releases.</li><li>Unless explicitly mentioned in the documentation, all fields of a struct are private. These are not safe to use, because they may break in any JuMP release, including patch releases. An example of a field which is safe to use is the <code>model.ext</code> extension dictionary, which is documented in <a href="#The-extension-dictionary">The extension dictionary</a>.</li></ul><p>In general, we strongly encourage you to use only the public API of JuMP. If you are missing a feature, please open a GitHub issue.</p><p>However, if you <em>do</em> use the private API (for example, because your feature request has not been implemented yet), then you must carefully restrict the versions of JuMP that your package is compatible with in the <code>Project.toml</code> file. The easiest way to do this is via the <a href="https://pkgdocs.julialang.org/v1/compatibility/">hyphen specifiers</a>. For example, if your package supports all JuMP versions between v1.0.0 and v1.1.1, do:</p><pre><code class="nohighlight hljs">JuMP = &quot;1.0.0 - 1.1.1&quot;</code></pre><p>Then, whenever JuMP releases a new version, you should check if your package is still compatible and update the bound accordingly.</p><h2 id="Define-a-new-set"><a class="docs-heading-anchor" href="#Define-a-new-set">Define a new set</a><a id="Define-a-new-set-1"></a><a class="docs-heading-anchor-permalink" href="#Define-a-new-set" title="Permalink"></a></h2><p>To define a new set for JuMP, subtype <code>MOI.AbstractScalarSet</code> or <code>MOI.AbstractVectorSet</code> and implement <code>Base.copy</code> for the set. That&#39;s it!</p><pre><code class="language-julia hljs">struct _NewVectorSet &lt;: MOI.AbstractVectorSet
    dimension::Int
end
Base.copy(x::_NewVectorSet) = x

model = Model()
@variable(model, x[1:2])
@constraint(model, x in _NewVectorSet(2))

# output

[x[1], x[2]] ∈ _NewVectorSet(2)</code></pre><p>However, for vector-sets, this requires the user to specify the dimension argument to their set, even though we could infer it from the length of <code>x</code>!</p><p>You can make a more user-friendly set by subtyping <a href="../../reference/extensions/#JuMP.AbstractVectorSet"><code>AbstractVectorSet</code></a> and implementing <a href="../../reference/constraints/#JuMP.moi_set"><code>moi_set</code></a>.</p><pre><code class="language-julia hljs">struct NewVectorSet &lt;: JuMP.AbstractVectorSet end
JuMP.moi_set(::NewVectorSet, dim::Int) = _NewVectorSet(dim)

model = Model()
@variable(model, x[1:2])
@constraint(model, x in NewVectorSet())

# output

[x[1], x[2]] ∈ _NewVectorSet(2)</code></pre><h2 id="extend_variable_macro"><a class="docs-heading-anchor" href="#extend_variable_macro">Extend <code>@variable</code></a><a id="extend_variable_macro-1"></a><a class="docs-heading-anchor-permalink" href="#extend_variable_macro" title="Permalink"></a></h2><p>Just as <code>Bin</code> and <code>Int</code> create binary and integer variables, you can extend the <a href="../../reference/variables/#JuMP.@variable"><code>@variable</code></a> macro to create new types of variables. Here is an explanation by example, where we create a <code>AddTwice</code> type, that creates a tuple of two JuMP variables instead of a single variable.</p><p>First, create a new struct. This can be anything. Our struct holds a <a href="../../reference/extensions/#JuMP.VariableInfo"><code>VariableInfo</code></a> object that stores bound information, and whether the variable is binary or integer.</p><pre><code class="language-julia-repl hljs">julia&gt; struct AddTwice
           info::JuMP.VariableInfo
       end</code></pre><p>Second, implement <a href="../../reference/extensions/#JuMP.build_variable"><code>build_variable</code></a>, which takes <code>::Type{AddTwice}</code> as an argument, and returns an instance of <code>AddTwice</code>. Note that you can also receive keyword arguments.</p><pre><code class="language-julia-repl hljs">julia&gt; function JuMP.build_variable(
           _err::Function,
           info::JuMP.VariableInfo,
           ::Type{AddTwice};
           kwargs...
       )
           println(&quot;Can also use $kwargs here.&quot;)
           return AddTwice(info)
       end</code></pre><p>Third, implement <a href="../../reference/extensions/#JuMP.add_variable"><code>add_variable</code></a>, which takes the instance of <code>AddTwice</code> from the previous step, and returns something. Typically, you will want to call <a href="../../reference/extensions/#JuMP.add_variable"><code>add_variable</code></a> here. For example, our <code>AddTwice</code> call is going to add two JuMP variables.</p><pre><code class="language-julia-repl hljs">julia&gt; function JuMP.add_variable(
           model::JuMP.Model,
           duplicate::AddTwice,
           name::String,
       )
           a = JuMP.add_variable(
               model,
               JuMP.ScalarVariable(duplicate.info),
               name * &quot;_a&quot;,
            )
           b = JuMP.add_variable(
               model,
               JuMP.ScalarVariable(duplicate.info),
               name * &quot;_b&quot;,
            )
           return (a, b)
       end</code></pre><p>Now <code>AddTwice</code> can be passed to <a href="../../reference/variables/#JuMP.@variable"><code>@variable</code></a> similar to <code>Bin</code> or <code>Int</code>, or through the <code>variable_type</code> keyword. However, now it adds two variables instead of one!</p><pre><code class="language-julia-repl hljs">julia&gt; model = Model();

julia&gt; @variable(model, x[i=1:2], variable_type = AddTwice, kw = i)
Can also use Base.Iterators.Pairs(:kw =&gt; 1) here.
Can also use Base.Iterators.Pairs(:kw =&gt; 2) here.
2-element Vector{Tuple{VariableRef, VariableRef}}:
 (x[1]_a, x[1]_b)
 (x[2]_a, x[2]_b)

julia&gt; num_variables(model)
4

julia&gt; first(x[1])
x[1]_a

julia&gt; last(x[2])
x[2]_b</code></pre><h2 id="Extend-[@constraint](@ref)"><a class="docs-heading-anchor" href="#Extend-[@constraint](@ref)">Extend <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a></a><a id="Extend-[@constraint](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#Extend-[@constraint](@ref)" title="Permalink"></a></h2><p>The <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> macro has three steps that can be intercepted and extended: parse time, build time, and add time.</p><h3 id="Parse"><a class="docs-heading-anchor" href="#Parse">Parse</a><a id="Parse-1"></a><a class="docs-heading-anchor-permalink" href="#Parse" title="Permalink"></a></h3><p>To extend the <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> macro at parse time, implement one of the following methods:</p><ul><li><a href="../../reference/extensions/#JuMP.parse_constraint_head"><code>parse_constraint_head</code></a></li><li><a href="../../reference/extensions/#JuMP.parse_constraint_call"><code>parse_constraint_call</code></a></li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Extending the constraint macro at parse time is an advanced operation and has the potential to interfere with existing JuMP syntax. Please discuss with the <a href="https://gitter.im/JuliaOpt/jump-dev">developer chatroom</a> before publishing any code that implements these methods.</p></div></div><p><a href="../../reference/extensions/#JuMP.parse_constraint_head"><code>parse_constraint_head</code></a> should be implemented to intercept an expression based on the <code>.head</code> field of <code>Base.Expr</code>. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; using JuMP

julia&gt; const MutableArithmetics = JuMP._MA;

julia&gt; model = Model(); @variable(model, x);

julia&gt; function JuMP.parse_constraint_head(
           _error::Function,
           ::Val{:(:=)},
           lhs,
           rhs,
       )
           println(&quot;Rewriting := as ==&quot;)
           new_lhs, parse_code = MutableArithmetics.rewrite(lhs)
           build_code = :(
               build_constraint($(_error), $(new_lhs), MOI.EqualTo($(rhs)))
           )
           return false, parse_code, build_code
       end

julia&gt; @constraint(model, x + x := 1.0)
Rewriting := as ==
2 x = 1.0</code></pre><p><a href="../../reference/extensions/#JuMP.parse_constraint_call"><code>parse_constraint_call</code></a> should be implemented to intercept an expression of the form <code>Expr(:call, op, args...)</code>. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; using JuMP

julia&gt; const MutableArithmetics = JuMP._MA;

julia&gt; model = Model(); @variable(model, x);

julia&gt; function JuMP.parse_constraint_call(
           _error::Function,
           is_vectorized::Bool,
           ::Val{:my_equal_to},
           lhs,
           rhs,
       )
           println(&quot;Rewriting my_equal_to to ==&quot;)
           new_lhs, parse_code = MutableArithmetics.rewrite(lhs)
           build_code = if is_vectorized
               :(build_constraint($(_error), $(new_lhs), MOI.EqualTo($(rhs)))
           )
           else
               :(build_constraint.($(_error), $(new_lhs), MOI.EqualTo($(rhs))))
           end
           return parse_code, build_code
       end

julia&gt; @constraint(model, my_equal_to(x + x, 1.0))
Rewriting my_equal_to to ==
2 x = 1.0</code></pre><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>When parsing a constraint you can recurse into sub-constraint (e.g., the <code>{expr}</code> in <code>z =&gt; {x &lt;= 1}</code>) by calling <a href="../../reference/extensions/#JuMP.parse_constraint"><code>parse_constraint</code></a>.</p></div></div><h3 id="Build"><a class="docs-heading-anchor" href="#Build">Build</a><a id="Build-1"></a><a class="docs-heading-anchor-permalink" href="#Build" title="Permalink"></a></h3><p>To extend the <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> macro at build time, implement a new <a href="../../reference/extensions/#JuMP.build_constraint"><code>build_constraint</code></a> method.</p><p>This may mean implementing a method for a specific function or set created at parse time, or it may mean implementing a method which handles additional positional arguments.</p><p><a href="../../reference/extensions/#JuMP.build_constraint"><code>build_constraint</code></a> must return an <a href="../../reference/constraints/#JuMP.AbstractConstraint"><code>AbstractConstraint</code></a>, which can either be an <a href="../../reference/constraints/#JuMP.AbstractConstraint"><code>AbstractConstraint</code></a> already supported by JuMP, e.g., <code>ScalarConstraint</code> or <code>VectorConstraint</code>, or a custom <a href="../../reference/constraints/#JuMP.AbstractConstraint"><code>AbstractConstraint</code></a> with a corresponding <a href="../../reference/extensions/#JuMP.add_constraint"><code>add_constraint</code></a> method (see <a href="#extension_add_constraint">Add</a>).</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>The easiest way to extend <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> is via an additional positional argument to <a href="../../reference/extensions/#JuMP.build_constraint"><code>build_constraint</code></a>.</p></div></div><p>Here is an example of adding extra arguments to <a href="../../reference/extensions/#JuMP.build_constraint"><code>build_constraint</code></a>:</p><pre><code class="language-julia-repl hljs">julia&gt; model = Model(); @variable(model, x);

julia&gt; struct MyConstrType end

julia&gt; function JuMP.build_constraint(
            _error::Function,
            f::JuMP.GenericAffExpr,
            set::MOI.EqualTo,
            extra::Type{MyConstrType};
            d = 0,
       )
            new_set = MOI.LessThan(set.value + d)
            return JuMP.build_constraint(_error, f, new_set)
       end

julia&gt; @constraint(model, my_con, x == 0, MyConstrType, d = 2)
my_con : x ≤ 2.0</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Only a single positional argument can be given to a particular constraint. Extensions that seek to pass multiple arguments (e.g., <code>Foo</code> and <code>Bar</code>) should combine them into one argument type (e.g., <code>FooBar</code>).</p></div></div><h3 id="extension_add_constraint"><a class="docs-heading-anchor" href="#extension_add_constraint">Add</a><a id="extension_add_constraint-1"></a><a class="docs-heading-anchor-permalink" href="#extension_add_constraint" title="Permalink"></a></h3><p><a href="../../reference/extensions/#JuMP.build_constraint"><code>build_constraint</code></a> returns an <a href="../../reference/constraints/#JuMP.AbstractConstraint"><code>AbstractConstraint</code></a> object. To extend <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> at add time, define a subtype of <a href="../../reference/constraints/#JuMP.AbstractConstraint"><code>AbstractConstraint</code></a>, implement <a href="../../reference/extensions/#JuMP.build_constraint"><code>build_constraint</code></a> to return an instance of the new type, and then implement <a href="../../reference/extensions/#JuMP.add_constraint"><code>add_constraint</code></a>.</p><p>Here is an example:</p><pre><code class="language-julia-repl hljs">julia&gt; model = Model(); @variable(model, x);

julia&gt; struct MyTag
           name::String
       end

julia&gt; struct MyConstraint{S} &lt;: AbstractConstraint
           name::String
           f::AffExpr
           s::S
       end

julia&gt; function JuMP.build_constraint(
            _error::Function,
            f::AffExpr,
            set::MOI.AbstractScalarSet,
            extra::MyTag,
       )
            return MyConstraint(extra.name, f, set)
       end

julia&gt; function JuMP.add_constraint(
            model::Model,
            con::MyConstraint,
            name::String,
       )
            return add_constraint(
                model,
                ScalarConstraint(con.f, con.s),
                &quot;$(con.name)[$(name)]&quot;,
            )
       end

julia&gt; @constraint(model, my_con, 2x &lt;= 1, MyTag(&quot;my_prefix&quot;))
my_prefix[my_con] : 2 x - 1 ≤ 0.0</code></pre><h2 id="The-extension-dictionary"><a class="docs-heading-anchor" href="#The-extension-dictionary">The extension dictionary</a><a id="The-extension-dictionary-1"></a><a class="docs-heading-anchor-permalink" href="#The-extension-dictionary" title="Permalink"></a></h2><p>Every JuMP model has a field <code>.ext::Dict{Symbol,Any}</code> that can be used by extensions. This is useful if your extensions to <a href="../../reference/variables/#JuMP.@variable"><code>@variable</code></a> and <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> need to store information between calls.</p><p>The most common way to initialize a model with information in the <code>.ext</code> dictionary is to provide a new constructor:</p><pre><code class="language-julia-repl hljs">julia&gt; function MyModel()
           model = Model()
           model.ext[:MyModel] = 1
           return model
       end
MyModel (generic function with 1 method)

julia&gt; model = MyModel()
A JuMP Model
Feasibility problem with:
Variables: 0
Model mode: AUTOMATIC
CachingOptimizer state: NO_OPTIMIZER
Solver name: No optimizer attached.

julia&gt; model.ext
Dict{Symbol, Any} with 1 entry:
  :MyModel =&gt; 1</code></pre><p>If you define extension data, implement <a href="../../reference/models/#JuMP.copy_extension_data"><code>copy_extension_data</code></a> to support <a href="../../reference/models/#JuMP.copy_model"><code>copy_model</code></a>.</p><h2 id="Defining-new-JuMP-models"><a class="docs-heading-anchor" href="#Defining-new-JuMP-models">Defining new JuMP models</a><a id="Defining-new-JuMP-models-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-new-JuMP-models" title="Permalink"></a></h2><p>If extending individual calls to <a href="../../reference/variables/#JuMP.@variable"><code>@variable</code></a> and <a href="../../reference/constraints/#JuMP.@constraint"><code>@constraint</code></a> is not sufficient, it is possible to implement a new model via a subtype of <a href="../../reference/models/#JuMP.AbstractModel"><code>AbstractModel</code></a>. You can also define new <a href="../../reference/variables/#JuMP.AbstractVariableRef"><code>AbstractVariableRef</code></a>s to create different types of JuMP variables.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Extending JuMP in this manner is an advanced operation. We strongly encourage you to consider how you can use the methods mentioned in the previous sections to achieve your aims instead of defining new model and variable types. Consult the <a href="https://gitter.im/JuliaOpt/jump-dev">developer chatroom</a> <em>before</em> starting work on this.</p></div></div><p>If you define new types, you will need to implement a considerable number of methods, and doing so will require a detailed understanding of the JuMP internals. Therefore, the list of methods to implement is currently undocumented.</p><p>The easiest way to extend JuMP by defining a new model type is to follow an existing example. A simple example to follow is the <a href="https://github.com/jump-dev/JuMP.jl/blob/master/test/JuMPExtension.jl">JuMPExtension module</a> in the JuMP test suite. The best example of an external JuMP extension that implements an <a href="../../reference/models/#JuMP.AbstractModel"><code>AbstractModel</code></a> is <a href="https://github.com/infiniteopt/InfiniteOpt.jl">InfiniteOpt.jl</a>.</p><h2 id="Set-an-optimize!-hook"><a class="docs-heading-anchor" href="#Set-an-optimize!-hook">Set an <code>optimize!</code> hook</a><a id="Set-an-optimize!-hook-1"></a><a class="docs-heading-anchor-permalink" href="#Set-an-optimize!-hook" title="Permalink"></a></h2><p>Some extensions require modification to the problem after the user has finished constructing the problem, but before <code>optimize!</code> is called. For these situations, JuMP provides <a href="../../reference/models/#JuMP.set_optimize_hook"><code>set_optimize_hook</code></a>, which lets you intercept the <a href="../../reference/solutions/#JuMP.optimize!"><code>optimize!</code></a> call.</p><p>Here&#39;s a simple example of adding an optimize hook that extends <a href="../../reference/solutions/#JuMP.optimize!"><code>optimize!</code></a> to take a keyword argument <code>silent</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using JuMP, HiGHS

julia&gt; model = Model(HiGHS.Optimizer);

julia&gt; @variable(model, x &gt;= 1.5, Int);

julia&gt; @objective(model, Min, x);

julia&gt; function silent_hook(model; silent::Bool)
           if silent
               set_silent(model)
           else
               unset_silent(model)
           end
           ## Make sure you set ignore_optimize_hook = true, or we&#39;ll
           ## recursively enter the optimize hook!
           return optimize!(model; ignore_optimize_hook = true)
       end
silent_hook (generic function with 1 method)

julia&gt; set_optimize_hook(model, silent_hook)
silent_hook (generic function with 1 method)

julia&gt; optimize!(model; silent = true)

julia&gt; optimize!(model; silent = false)
Presolving model
0 rows, 0 cols, 0 nonzeros
0 rows, 0 cols, 0 nonzeros
Presolve: Optimal

Solving report
  Status            Optimal
  Primal bound      2
  Dual bound        2
  Gap               0% (tolerance: 0.01%)
  Solution status   feasible
                    2 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            0.00 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             0
  LP iterations     0 (total)
                    0 (strong br.)
                    0 (separation)
                    0 (heuristics)</code></pre><h2 id="Creating-new-container-types"><a class="docs-heading-anchor" href="#Creating-new-container-types">Creating new container types</a><a id="Creating-new-container-types-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-new-container-types" title="Permalink"></a></h2><p>JuMP macros (for example, <a href="../../reference/variables/#JuMP.@variable"><code>@variable</code></a>) accept a <code>container</code> keyword argument to force the type of container that is chosen. By default, JuMP supports <code>container = Array</code>, <code>container = DenseAxisArray</code>, <code>container = SparseAxisArray</code> and <code>container = Auto</code>. You can extend support to user-defined types by implementing <a href="../../reference/containers/#JuMP.Containers.container"><code>Containers.container</code></a>.</p><p>For example, here is a container that reverses the order of the indices:</p><pre><code class="language-julia-repl hljs">julia&gt; struct Foo end

julia&gt; function Containers.container(f::Function, indices, ::Type{Foo})
           return reverse([f(i...) for i in indices])
       end

julia&gt; model = Model();

julia&gt; @variable(model, x[1:3], container = Foo)
3-element Vector{VariableRef}:
 x[3]
 x[2]
 x[1]

julia&gt; x[1]
x[3]

julia&gt; @variable(model, y[1:3, 1:2], container = Foo)
3×2 Matrix{VariableRef}:
 y[3,2]  y[3,1]
 y[2,2]  y[2,1]
 y[1,2]  y[1,1]

julia&gt; y[1, 1]
y[3,2]

julia&gt; @variable(model, z[i=1:3; isodd(i)], container = Foo)
2-element Vector{VariableRef}:
 z[3]
 z[1]

julia&gt; z[2]
z[1]</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If you are a general user, you should not need to create a new container type. Instead, consider following <a href="../../manual/variables/#User-defined-containers">User-defined containers</a> and create a new container using standard Julia syntax. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; model = Model();

julia&gt; @variable(model, x[1:3])
3-element Vector{VariableRef}:
 x[1]
 x[2]
 x[3]

julia&gt; y = reverse(x)
3-element Vector{VariableRef}:
 x[3]
 x[2]
 x[1]</code></pre></div></div><h2 id="Performance-tips-for-extensions"><a class="docs-heading-anchor" href="#Performance-tips-for-extensions">Performance tips for extensions</a><a id="Performance-tips-for-extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-tips-for-extensions" title="Permalink"></a></h2><p>The function-in-set design of MathOptInterface causes type stability issues in Julia if you try to iterate over all of the constraints in a model. The easiest way to fix this is to use a function barrier.</p><p>For example, instead of:</p><pre><code class="language-julia hljs">function all_names_slow(model)
    names = Set{String}()
    for ci in all_constraints(model)
        push!(names, name(ci))
    end
    return names
end</code></pre><p>use:</p><pre><code class="language-julia hljs">function _function_barrier(names, model, ::Type{F}, ::Type{S}) where {F,S}
    for ci in all_constraints(model, F, S)
        push!(names, name(ci))
    end
    return
end

function all_names_fast(model)
    names = Set{String}()
    for (F, S) in list_of_constraint_types(model)
        _function_barrier(names, model, F, S)
    end
    return names
end</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is important to explicitly type the <code>F</code> and <code>S</code> arguments. If you leave them untyped, for example, <code>function _function_barrier(names, model, F, S)</code>, Julia will not specialize the function calls and performance will not be improved.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../contributing/">« Contributing</a><a class="docs-footer-nextpage" href="../custom_solver_binaries/">Custom binaries »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Tuesday 16 August 2022 04:42">Tuesday 16 August 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
