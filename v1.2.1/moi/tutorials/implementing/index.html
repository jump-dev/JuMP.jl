<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implementing a solver interface · JuMP</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-44252521-1"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-44252521-1', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/extra_styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="JuMP logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="JuMP logo"/></a><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../should_i_use/">Should I use JuMP?</a></li><li><a class="tocitem" href="../../../installation/">Installation Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/getting_started/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../tutorials/getting_started/getting_started_with_julia/">Getting started with Julia</a></li><li><a class="tocitem" href="../../../tutorials/getting_started/getting_started_with_JuMP/">Getting started with JuMP</a></li><li><a class="tocitem" href="../../../tutorials/getting_started/getting_started_with_sets_and_indexing/">Getting started with sets and indexing</a></li><li><a class="tocitem" href="../../../tutorials/getting_started/getting_started_with_data_and_plotting/">Getting started with data and plotting</a></li><li><a class="tocitem" href="../../../tutorials/getting_started/performance_tips/">Performance tips</a></li><li><a class="tocitem" href="../../../tutorials/getting_started/design_patterns_for_larger_models/">Design patterns for larger models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/linear/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../tutorials/linear/tips_and_tricks/">Tips and tricks</a></li><li><a class="tocitem" href="../../../tutorials/linear/diet/">The diet problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/cannery/">The cannery problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/facility_location/">The facility location problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/factory_schedule/">The factory schedule example</a></li><li><a class="tocitem" href="../../../tutorials/linear/finance/">Financial modeling problems</a></li><li><a class="tocitem" href="../../../tutorials/linear/geographic_clustering/">Geographical clustering</a></li><li><a class="tocitem" href="../../../tutorials/linear/knapsack/">The knapsack problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/multi/">The multi-commodity flow problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/n-queens/">N-Queens</a></li><li><a class="tocitem" href="../../../tutorials/linear/lp_sensitivity/">Sensitivity analysis of a linear program</a></li><li><a class="tocitem" href="../../../tutorials/linear/network_flows/">Network flow problems</a></li><li><a class="tocitem" href="../../../tutorials/linear/prod/">The workforce scheduling problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/steelT3/">The SteelT3 problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/sudoku/">Sudoku</a></li><li><a class="tocitem" href="../../../tutorials/linear/transp/">The transportation problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/urban_plan/">The urban planning problem</a></li><li><a class="tocitem" href="../../../tutorials/linear/callbacks/">Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Nonlinear programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/nonlinear/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/tips_and_tricks/">Tips and tricks</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/portfolio/">Quadratic portfolio optimization</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/qcp/">Quadratically constrained programs</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/space_shuttle_reentry_trajectory/">Optimal control for a Space Shuttle reentry trajectory</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/rocket_control/">Rocket Control</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/rosenbrock/">The Rosenbrock function</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/mle/">Maximum likelihood estimation</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/clnlbeam/">The clnlbeam problem</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/user_defined_hessians/">User-defined Hessians</a></li><li><a class="tocitem" href="../../../tutorials/nonlinear/querying_hessians/">Computing Hessians</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Conic programs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/conic/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../tutorials/conic/start_values/">Primal and dual warm-starts</a></li><li><a class="tocitem" href="../../../tutorials/conic/tips_and_tricks/">Tips and Tricks</a></li><li><a class="tocitem" href="../../../tutorials/conic/logistic_regression/">Logistic regression</a></li><li><a class="tocitem" href="../../../tutorials/conic/cluster/">K-means clustering via SDP</a></li><li><a class="tocitem" href="../../../tutorials/conic/corr_sdp/">The correlation problem</a></li><li><a class="tocitem" href="../../../tutorials/conic/experiment_design/">Experiment design</a></li><li><a class="tocitem" href="../../../tutorials/conic/max_cut_sdp/">SDP relaxations: max-cut</a></li><li><a class="tocitem" href="../../../tutorials/conic/min_distortion/">The minimum distortion problem</a></li><li><a class="tocitem" href="../../../tutorials/conic/min_ellipse/">Minimal ellipses</a></li><li><a class="tocitem" href="../../../tutorials/conic/robust_uncertainty/">Robust uncertainty sets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/algorithms/benders_decomposition/">Benders decomposition</a></li><li><a class="tocitem" href="../../../tutorials/algorithms/cutting_stock_column_generation/">Column generation</a></li><li><a class="tocitem" href="../../../tutorials/algorithms/tsp_lazy_constraints/">Traveling Salesperson Problem</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Applications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/applications/power_systems/">Power Systems</a></li><li><a class="tocitem" href="../../../tutorials/applications/web_app/">Serving web apps</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../manual/models/">Models</a></li><li><a class="tocitem" href="../../../manual/variables/">Variables</a></li><li><a class="tocitem" href="../../../manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../manual/expressions/">Expressions</a></li><li><a class="tocitem" href="../../../manual/objective/">Objectives</a></li><li><a class="tocitem" href="../../../manual/containers/">Containers</a></li><li><a class="tocitem" href="../../../manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../manual/nlp/">Nonlinear Modeling</a></li><li><a class="tocitem" href="../../../manual/callbacks/">Solver-independent Callbacks</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../reference/models/">Models</a></li><li><a class="tocitem" href="../../../reference/variables/">Variables</a></li><li><a class="tocitem" href="../../../reference/expressions/">Expressions</a></li><li><a class="tocitem" href="../../../reference/objectives/">Objectives</a></li><li><a class="tocitem" href="../../../reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../reference/containers/">Containers</a></li><li><a class="tocitem" href="../../../reference/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../reference/nlp/">Nonlinear Modeling</a></li><li><a class="tocitem" href="../../../reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../../reference/extensions/">Extensions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Background Information</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../background/algebraic_modeling_languages/">Algebraic modeling languages</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../developers/contributing/">Contributing</a></li><li><a class="tocitem" href="../../../developers/extensions/">Extensions</a></li><li><a class="tocitem" href="../../../developers/custom_solver_binaries/">Custom binaries</a></li><li><a class="tocitem" href="../../../developers/style/">Style Guide</a></li><li><a class="tocitem" href="../../../developers/roadmap/">Roadmap</a></li></ul></li><li><a class="tocitem" href="../../../release_notes/">Release notes</a></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox" checked/><label class="tocitem" for="menuitem-8"><span class="docs-label">MathOptInterface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../background/motivation/">Motivation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox" checked/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../example/">Solving a problem using MathOptInterface</a></li><li class="is-active"><a class="tocitem" href>Implementing a solver interface</a><ul class="internal"><li><a class="tocitem" href="#A-note-on-the-API"><span>A note on the API</span></a></li><li><a class="tocitem" href="#Preliminaries"><span>Preliminaries</span></a></li><li><a class="tocitem" href="#Structuring-the-package"><span>Structuring the package</span></a></li><li><a class="tocitem" href="#Initial-code"><span>Initial code</span></a></li><li><a class="tocitem" href="#The-big-decision:-copy-to-or-incremental-modifications?"><span>The big decision: copy-to or incremental modifications?</span></a></li><li><a class="tocitem" href="#implement_names"><span>Names</span></a></li><li><a class="tocitem" href="#Solutions"><span>Solutions</span></a></li><li><a class="tocitem" href="#Other-tips"><span>Other tips</span></a></li></ul></li><li><a class="tocitem" href="../mathprogbase/">Transitioning from MathProgBase</a></li><li><a class="tocitem" href="../bridging_constraint/">Implementing a constraint bridge</a></li><li><a class="tocitem" href="../manipulating_expressions/">Manipulating expressions</a></li><li><a class="tocitem" href="../latency/">Latency</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/standard_form/">Standard form problem</a></li><li><a class="tocitem" href="../../manual/models/">Models</a></li><li><a class="tocitem" href="../../manual/variables/">Variables</a></li><li><a class="tocitem" href="../../manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../manual/modification/">Problem modification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../background/duality/">Duality</a></li><li><a class="tocitem" href="../../background/infeasibility_certificates/">Infeasibility certificates</a></li><li><a class="tocitem" href="../../background/naming_conventions/">Naming conventions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/standard_form/">Standard form</a></li><li><a class="tocitem" href="../../reference/models/">Models</a></li><li><a class="tocitem" href="../../reference/variables/">Variables</a></li><li><a class="tocitem" href="../../reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../reference/modification/">Modifications</a></li><li><a class="tocitem" href="../../reference/nonlinear/">Nonlinear programming</a></li><li><a class="tocitem" href="../../reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference/errors/">Errors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-8-6-1" type="checkbox"/><label class="tocitem" for="menuitem-8-6-1"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/Benchmarks/overview/">Overview</a></li><li><a class="tocitem" href="../../submodules/Benchmarks/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-2" type="checkbox"/><label class="tocitem" for="menuitem-8-6-2"><span class="docs-label">Bridges</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/Bridges/overview/">Overview</a></li><li><a class="tocitem" href="../../submodules/Bridges/list_of_bridges/">List of bridges</a></li><li><a class="tocitem" href="../../submodules/Bridges/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-3" type="checkbox"/><label class="tocitem" for="menuitem-8-6-3"><span class="docs-label">FileFormats</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/FileFormats/overview/">Overview</a></li><li><a class="tocitem" href="../../submodules/FileFormats/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-4" type="checkbox"/><label class="tocitem" for="menuitem-8-6-4"><span class="docs-label">Nonlinear</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/Nonlinear/overview/">Overview</a></li><li><a class="tocitem" href="../../submodules/Nonlinear/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-5" type="checkbox"/><label class="tocitem" for="menuitem-8-6-5"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/Utilities/overview/">Overview</a></li><li><a class="tocitem" href="../../submodules/Utilities/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-6-6" type="checkbox"/><label class="tocitem" for="menuitem-8-6-6"><span class="docs-label">Test</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/Test/overview/">Overview</a></li><li><a class="tocitem" href="../../submodules/Test/reference/">API Reference</a></li></ul></li></ul></li><li><a class="tocitem" href="../../release_notes/">Release notes</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">MathOptInterface</a></li><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Implementing a solver interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implementing a solver interface</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jump-dev/JuMP.jl/blob/master/docs/src/moi/tutorials/implementing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Implementing-a-solver-interface"><a class="docs-heading-anchor" href="#Implementing-a-solver-interface">Implementing a solver interface</a><a id="Implementing-a-solver-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-a-solver-interface" title="Permalink"></a></h1><p>This guide outlines the basic steps to implement an interface to MathOptInterface for a new solver.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Implementing an interface to MathOptInterface for a new solver is a lot of work. Before starting, we recommend that you join the <a href="https://gitter.im/JuliaOpt/JuMP-dev">Developer chatroom</a> and explain a little bit about the solver you are wrapping. If you have questions that are not answered by this guide, please ask them in the <a href="https://gitter.im/JuliaOpt/JuMP-dev">Developer chatroom</a> so we can improve this guide!</p></div></div><h2 id="A-note-on-the-API"><a class="docs-heading-anchor" href="#A-note-on-the-API">A note on the API</a><a id="A-note-on-the-API-1"></a><a class="docs-heading-anchor-permalink" href="#A-note-on-the-API" title="Permalink"></a></h2><p>The API of MathOptInterface is large and varied. In order to support the diversity of solvers and use-cases, we make heavy use of <a href="https://en.wikipedia.org/wiki/Duck_typing">duck-typing</a>. That is, solvers are not expected to implement the full API, nor is there a well-defined minimal subset of what must be implemented. Instead, you should implement the API as necessary in order to make the solver function as you require.</p><p>The main reason for using duck-typing is that solvers work in different ways and target different use-cases.</p><p>For example:</p><ul><li>Some solvers support incremental problem construction, support modification after a solve, and have native support for things like variable names.</li><li>Other solvers are &quot;one-shot&quot; solvers that require all of the problem data to construct and solve the problem in a single function call. They do not support modification or things like variable names.</li><li>Other &quot;solvers&quot; are not solvers at all, but things like file readers. These may only support functions like <a href="../../reference/models/#MathOptInterface.read_from_file"><code>read_from_file</code></a>, and may not even support the ability to add variables or constraints directly!</li><li>Finally, some &quot;solvers&quot; are layers which take a problem as input, transform it according to some rules, and pass the transformed problem to an inner solver.</li></ul><h2 id="Preliminaries"><a class="docs-heading-anchor" href="#Preliminaries">Preliminaries</a><a id="Preliminaries-1"></a><a class="docs-heading-anchor-permalink" href="#Preliminaries" title="Permalink"></a></h2><p>Before starting on your wrapper, you should do some background research and make the solver accessible via Julia.</p><h3 id="Decide-if-MathOptInterface-is-right-for-you"><a class="docs-heading-anchor" href="#Decide-if-MathOptInterface-is-right-for-you">Decide if MathOptInterface is right for you</a><a id="Decide-if-MathOptInterface-is-right-for-you-1"></a><a class="docs-heading-anchor-permalink" href="#Decide-if-MathOptInterface-is-right-for-you" title="Permalink"></a></h3><p>The first step in writing a wrapper is to decide whether implementing an interface is the right thing to do.</p><p>MathOptInterface is an abstraction layer for unifying <em>constrained</em> mathematical optimization solvers. If your solver doesn&#39;t fit in the category, i.e., it implements a derivative-free algorithm for unconstrained objective functions, MathOptInterface may not be the right tool for the job.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>If you&#39;re not sure whether you should write an interface, ask in the <a href="https://gitter.im/JuliaOpt/JuMP-dev">Developer chatroom</a>.</p></div></div><h3 id="Find-a-similar-solver-already-wrapped"><a class="docs-heading-anchor" href="#Find-a-similar-solver-already-wrapped">Find a similar solver already wrapped</a><a id="Find-a-similar-solver-already-wrapped-1"></a><a class="docs-heading-anchor-permalink" href="#Find-a-similar-solver-already-wrapped" title="Permalink"></a></h3><p>The next step is to find (if possible) a similar solver that is already wrapped. Although not strictly necessary, this will be a good place to look for inspiration when implementing your wrapper.</p><p>The <a href="https://jump.dev/JuMP.jl/stable/installation/#Supported-solvers">JuMP documentation</a> has a good list of solvers, along with the problem classes they support.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>If you&#39;re not sure which solver is most similar, ask in the <a href="https://gitter.im/JuliaOpt/JuMP-dev">Developer chatroom</a>.</p></div></div><h3 id="Create-a-low-level-interface"><a class="docs-heading-anchor" href="#Create-a-low-level-interface">Create a low-level interface</a><a id="Create-a-low-level-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-low-level-interface" title="Permalink"></a></h3><p>Before writing a MathOptInterface wrapper, you first need to be able to call the solver from Julia.</p><h4 id="Wrapping-solvers-written-in-Julia"><a class="docs-heading-anchor" href="#Wrapping-solvers-written-in-Julia">Wrapping solvers written in Julia</a><a id="Wrapping-solvers-written-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Wrapping-solvers-written-in-Julia" title="Permalink"></a></h4><p>If your solver is written in Julia, there&#39;s nothing to do here! Go to the next section.</p><h4 id="Wrapping-solvers-written-in-C"><a class="docs-heading-anchor" href="#Wrapping-solvers-written-in-C">Wrapping solvers written in C</a><a id="Wrapping-solvers-written-in-C-1"></a><a class="docs-heading-anchor-permalink" href="#Wrapping-solvers-written-in-C" title="Permalink"></a></h4><p>Julia is well suited to wrapping solvers written in C.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>This is <em>not</em> true for C++. If you have a solver written in C++, first write a C interface, then wrap the C interface.</p></div></div><p>Before writing a MathOptInterface wrapper, there are a few extra steps.</p><h5 id="Create-a-JLL"><a class="docs-heading-anchor" href="#Create-a-JLL">Create a JLL</a><a id="Create-a-JLL-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-JLL" title="Permalink"></a></h5><p>If the C code is publicly available under an open-source license, create a JLL package via <a href="https://github.com/JuliaPackaging/Yggdrasil">Yggdrasil</a>. The easiest way to do this is to copy an existing solver. Good examples to follow are the <a href="https://github.com/JuliaPackaging/Yggdrasil/tree/master/C/Coin-OR">COIN-OR solvers</a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Building the solver via Yggdrasil is non-trivial. Please ask the <a href="https://gitter.im/JuliaOpt/JuMP-dev">Developer chatroom</a> for help.</p></div></div><p>If the code is commercial or not publicly available, the user will need to manually install the solver. See <a href="https://github.com/jump-dev/Gurobi.jl">Gurobi.jl</a> or <a href="https://github.com/jump-dev/CPLEX.jl">CPLEX.jl</a> for examples of how to structure this.</p><h5 id="implement_clang"><a class="docs-heading-anchor" href="#implement_clang">Use Clang.jl to wrap the C API</a><a id="implement_clang-1"></a><a class="docs-heading-anchor-permalink" href="#implement_clang" title="Permalink"></a></h5><p>The next step is to use <a href="https://github.com/JuliaInterop/Clang.jl">Clang.jl</a> to automatically wrap the C API. The easiest way to do this is to follow an example. Good examples to follow are <a href="https://github.com/jump-dev/Cbc.jl/blob/master/scripts/clang.jl">Cbc.jl</a> and <a href="https://github.com/jump-dev/HiGHS.jl/blob/master/gen/gen.jl">HiGHS.jl</a>.</p><p>Sometimes, you will need to make manual modifications to the resulting files.</p><h4 id="Solvers-written-in-other-languages"><a class="docs-heading-anchor" href="#Solvers-written-in-other-languages">Solvers written in other languages</a><a id="Solvers-written-in-other-languages-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers-written-in-other-languages" title="Permalink"></a></h4><p>Ask the <a href="https://gitter.im/JuliaOpt/JuMP-dev">Developer chatroom</a> for advice. You may be able to use one of the <a href="https://github.com/JuliaInterop">JuliaInterop</a> packages to call out to the solver.</p><p>For example, <a href="https://github.com/jump-dev/SeDuMi.jl">SeDuMi.jl</a> uses <a href="https://github.com/JuliaInterop/MATLAB.jl">MATLAB.jl</a> to call the SeDuMi solver written in MATLAB.</p><h2 id="Structuring-the-package"><a class="docs-heading-anchor" href="#Structuring-the-package">Structuring the package</a><a id="Structuring-the-package-1"></a><a class="docs-heading-anchor-permalink" href="#Structuring-the-package" title="Permalink"></a></h2><p>Structure your wrapper as a Julia package. Consult the <a href="https://pkgdocs.julialang.org/v1/creating-packages/">Julia documentation</a> if you haven&#39;t done this before.</p><p>MOI solver interfaces may be in the same package as the solver itself (either the C wrapper if the solver is accessible through C, or the Julia code if the solver is written in Julia, for example), or in a separate package which depends on the solver package.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The JuMP <a href="https://jump.dev/pages/governance/#core-contributors">core contributors</a> request that you do not use &quot;JuMP&quot; in the name of your package without prior consent.</p></div></div><p>Your package should have the following structure:</p><pre><code class="nohighlight hljs">/.github
    /workflows
        ci.yml
        format_check.yml
        TagBot.yml
/gen
    gen.jl  # Code to wrap the C API
/src
    NewSolver.jl
    /gen
        libnewsolver_api.jl
        libnewsolver_common.jl
    /MOI_wrapper
        MOI_wrapper.jl
        other_files.jl
/test
    runtests.jl
    /MOI_wrapper
        MOI_wrapper.jl
.gitignore
.JuliaFormatter.toml
README.md
LICENSE.md
Project.toml</code></pre><ul><li>The <code>/.github</code> folder contains the scripts for GitHub actions. The easiest way to write these is to copy the ones from an existing solver.</li><li>The <code>/gen</code> and <code>/src/gen</code> folders are only needed if you are wrapping a <a href="#implement_clang">solver written in C</a>.</li><li>The <code>/src/MOI_wrapper</code> folder contains the Julia code for the MOI wrapper.</li><li>The <code>/test</code> folder contains code for testing your package. See <a href="#Setup-tests">Setup tests</a> for more information.</li><li>The <code>.JuliaFormatter.toml</code> and <code>.github/workflows/format_check.yml</code> enforce code formatting using <a href="https://github.com/domluna/JuliaFormatter.jl">JuliaFormatter.jl</a>. Check existing solvers or JuMP.jl for details.</li></ul><h3 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h3><p>Your package must include documentation explaining how to use the package. The easiest approach is to include documentation in your <code>README.md</code>. A more involved option is to use <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a>.</p><p>Examples of packages with README-based documentation include:</p><ul><li><a href="https://github.com/jump-dev/Cbc.jl">Cbc.jl</a></li><li><a href="https://github.com/jump-dev/HiGHS.jl">HiGHS.jl</a></li><li><a href="https://github.com/jump-dev/SCS.jl">SCS.jl</a></li></ul><p>Examples of packages with Documenter-based documentation include:</p><ul><li><a href="https://github.com/lanl-ansi/Alpine.jl">Alpine.jl</a></li><li><a href="https://github.com/oxfordcontrol/COSMO.jl">COSMO.jl</a></li><li><a href="https://github.com/lanl-ansi/Juniper.jl">Juniper.jl</a></li></ul><h3 id="Setup-tests"><a class="docs-heading-anchor" href="#Setup-tests">Setup tests</a><a id="Setup-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Setup-tests" title="Permalink"></a></h3><p>The best way to implement an interface to MathOptInterface is via <a href="https://en.wikipedia.org/wiki/Test-driven_development">test-driven development</a>.</p><p>The <a href="../../submodules/Test/overview/#test_module"><code>MOI.Test</code> submodule</a> contains a large test suite to help check that you have implemented things correctly.</p><p>Follow the guide <a href="../../submodules/Test/overview/#How-to-test-a-solver">How to test a solver</a> to set up the tests for your package.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Run the tests frequently when developing. However, at the start there is going to be a lot of errors! Start by excluding large classes of tests (e.g., <code>exclude = [&quot;test_basic_&quot;, &quot;test_model_&quot;]</code>, implement any missing methods until the tests pass, then remove an exclusion and repeat.</p></div></div><h2 id="Initial-code"><a class="docs-heading-anchor" href="#Initial-code">Initial code</a><a id="Initial-code-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-code" title="Permalink"></a></h2><p>By this point, you should have a package setup with tests, formatting, and access to the underlying solver. Now it&#39;s time to start writing the wrapper.</p><h3 id="The-Optimizer-object"><a class="docs-heading-anchor" href="#The-Optimizer-object">The <code>Optimizer</code> object</a><a id="The-Optimizer-object-1"></a><a class="docs-heading-anchor-permalink" href="#The-Optimizer-object" title="Permalink"></a></h3><p>The first object to create is a subtype of <a href="../../reference/models/#MathOptInterface.AbstractOptimizer"><code>AbstractOptimizer</code></a>. This type is going to store everything related to the problem.</p><p>By convention, these optimizers should not be exported and should be named <code>PackageName.Optimizer</code>.</p><pre><code class="language-julia hljs">import MathOptInterface
const MOI = MathOptInterface

struct Optimizer &lt;: MOI.AbstractOptimizer
    # Fields go here
end</code></pre><h4 id="Optimizer-objects-for-C-solvers"><a class="docs-heading-anchor" href="#Optimizer-objects-for-C-solvers">Optimizer objects for C solvers</a><a id="Optimizer-objects-for-C-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizer-objects-for-C-solvers" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This section is important if you wrap a solver written in C.</p></div></div><p>Wrapping a solver written in C will require the use of pointers, and for you to manually free the solver&#39;s memory when the <code>Optimizer</code> is garbage collected by Julia.</p><p><strong>Never pass a pointer directly to a Julia <code>ccall</code> function.</strong></p><p>Instead, store the pointer as a field in your <code>Optimizer</code>, and implement <code>Base.cconvert</code> and <code>Base.unsafe_convert</code>. Then you can pass <code>Optimizer</code> to any <code>ccall</code> function that expects the pointer.</p><p>In addition, make sure you implement a <code>finalizer</code> for each model you create.</p><p>If <code>newsolver_createProblem()</code> is the low-level function that creates the problem pointer in C, and <code>newsolver_freeProblem(::Ptr{Cvoid})</code> is the low-level function that frees memory associated with the pointer, your <code>Optimizer()</code> function should look like this:</p><pre><code class="language-julia hljs">struct Optimizer &lt;: MOI.AbstractOptimizer
    ptr::Ptr{Cvoid}

    function Optimizer()
        ptr = newsolver_createProblem()
        model = Optimizer(ptr)
        finalizer(model) do m
            newsolver_freeProblem(m)
            return
        end
        return model
    end
end

Base.cconvert(::Type{Ptr{Cvoid}}, model::Optimizer) = model
Base.unsafe_convert(::Type{Ptr{Cvoid}}, model::Optimizer) = model.ptr</code></pre><h3 id="Implement-methods-for-Optimizer"><a class="docs-heading-anchor" href="#Implement-methods-for-Optimizer">Implement methods for <code>Optimizer</code></a><a id="Implement-methods-for-Optimizer-1"></a><a class="docs-heading-anchor-permalink" href="#Implement-methods-for-Optimizer" title="Permalink"></a></h3><p>All <code>Optimizer</code>s must implement the following methods:</p><ul><li><a href="../../reference/models/#MathOptInterface.empty!"><code>empty!</code></a></li><li><a href="../../reference/models/#MathOptInterface.is_empty"><code>is_empty</code></a></li><li><a href="../../reference/models/#MathOptInterface.optimize!"><code>optimize!</code></a></li></ul><p>Other methods, detailed below, are optional or depend on how you implement the interface.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>For this and all future methods, read the docstrings to understand what each method does, what it expects as input, and what it produces as output. If it isn&#39;t clear, let us know and we will improve the docstrings! It is also very helpful to look at an existing wrapper for a similar solver.</p></div></div><p>You should also implement <code>Base.show(::IO, ::Optimizer)</code> to print a nice string when someone prints your model. For example</p><pre><code class="language-julia hljs">function Base.show(io::IO, model::Optimizer)
    return print(io, &quot;NewSolver with the pointer $(model.ptr)&quot;)
end</code></pre><h3 id="Implement-attributes"><a class="docs-heading-anchor" href="#Implement-attributes">Implement attributes</a><a id="Implement-attributes-1"></a><a class="docs-heading-anchor-permalink" href="#Implement-attributes" title="Permalink"></a></h3><p>MathOptInterface uses attributes to manage different aspects of the problem.</p><p>For each attribute</p><ul><li><a href="../../reference/models/#MathOptInterface.get"><code>get</code></a> gets the current value of the attribute</li><li><a href="../../reference/models/#MathOptInterface.set"><code>set</code></a> sets a new value of the attribute. Not all attributes can be set. For example, the user can&#39;t modify the <a href="../../reference/models/#MathOptInterface.SolverName"><code>SolverName</code></a>.</li><li><a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a> returns a <code>Bool</code> indicating whether the solver supports the attribute.</li></ul><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Use <a href="../../reference/models/#MathOptInterface.attribute_value_type"><code>attribute_value_type</code></a> to check the value expected by a given attribute. You should make sure that your <a href="../../reference/models/#MathOptInterface.get"><code>get</code></a> function correctly infers to this type (or a subtype of it).</p></div></div><p>Each column in the table indicates whether you need to implement the particular method for each attribute.</p><table><tr><th style="text-align: right">Attribute</th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.get"><code>get</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.set"><code>set</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a></th></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.SolverName"><code>SolverName</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.SolverVersion"><code>SolverVersion</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.RawSolver"><code>RawSolver</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.Name"><code>Name</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.Silent"><code>Silent</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.TimeLimitSec"><code>TimeLimitSec</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.RawOptimizerAttribute"><code>RawOptimizerAttribute</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.NumberOfThreads"><code>NumberOfThreads</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.AbsoluteGapTolerance"><code>AbsoluteGapTolerance</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.RelativeGapTolerance"><code>RelativeGapTolerance</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr></table><p>For example:</p><pre><code class="language-julia hljs">function MOI.get(model::Optimizer, ::MOI.Silent)
    return # true if MOI.Silent is set
end

function MOI.set(model::Optimizer, ::MOI.Silent, v::Bool)
    if v
        # Set a parameter to turn off printing
    else
        # Restore the default printing
    end
    return
end

MOI.supports(::Optimizer, ::MOI.Silent) = true</code></pre><h3 id="Define-supports_constraint"><a class="docs-heading-anchor" href="#Define-supports_constraint">Define <code>supports_constraint</code></a><a id="Define-supports_constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Define-supports_constraint" title="Permalink"></a></h3><p>The next step is to define which constraints and objective functions you plan to support.</p><p>For each function-set constraint pair, define <a href="../../reference/constraints/#MathOptInterface.supports_constraint"><code>supports_constraint</code></a>:</p><pre><code class="language-julia hljs">function MOI.supports_constraint(
    ::Optimizer,
    ::Type{MOI.VariableIndex},
    ::Type{MOI.ZeroOne},
)
    return true
end</code></pre><p>To make this easier, you may want to use <code>Union</code>s:</p><pre><code class="language-julia hljs">function MOI.supports_constraint(
    ::Optimizer,
    ::Type{MOI.VariableIndex},
    ::Type{&lt;:Union{MOI.LessThan,MOI.GreaterThan,MOI.EqualTo}},
)
    return true
end</code></pre><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Only support a constraint if your solver has native support for it.</p></div></div><h2 id="The-big-decision:-copy-to-or-incremental-modifications?"><a class="docs-heading-anchor" href="#The-big-decision:-copy-to-or-incremental-modifications?">The big decision: copy-to or incremental modifications?</a><a id="The-big-decision:-copy-to-or-incremental-modifications?-1"></a><a class="docs-heading-anchor-permalink" href="#The-big-decision:-copy-to-or-incremental-modifications?" title="Permalink"></a></h2><p>Now you need to decide whether to support incremental modification or not.</p><p>Incremental modification means that the user can add variables and constraints one-by-one without needing to rebuild the entire problem, and they can modify the problem data after an <a href="../../reference/models/#MathOptInterface.optimize!"><code>optimize!</code></a> call. Supporting incremental modification means implementing functions like <a href="../../reference/variables/#MathOptInterface.add_variable"><code>add_variable</code></a> and <a href="../../reference/constraints/#MathOptInterface.add_constraint"><code>add_constraint</code></a>.</p><p>The alternative is to accept the problem data in a single <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a> function call, afterwhich it cannot be modified. Because <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a> sees all of the data at once, it can typically call a more efficient function to load data into the underlying solver.</p><p>Good examples of solvers supporting incremental modification are MILP solvers like <a href="https://github.com/jump-dev/GLPK.jl">GLPK.jl</a> and <a href="https://github.com/jump-dev/Gurobi.jl">Gurobi.jl</a>. Examples of <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a> solvers are <a href="https://github.com/jump-dev/AmplNLWriter.jl">AmplNLWriter.jl</a> and <a href="https://github.com/jump-dev/SCS.jl">SCS.jl</a></p><p>It is possible to implement both approaches, but you should probably start with one for simplicity.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Only support incremental modification if your solver has native support for it.</p></div></div><p>In general, supporting incremental modification is more work, and it usually requires some extra book-keeping. However, it provides a more efficient interface to the solver if the problem is going to be resolved multiple times with small modifications. Moreover, once you&#39;ve implemented incremental modification, it&#39;s usually not much extra work to add a <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a> interface. The converse is not true.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>If this is your first time writing an interface, start with <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a>.</p></div></div><h3 id="The-copy_to-interface"><a class="docs-heading-anchor" href="#The-copy_to-interface">The <code>copy_to</code> interface</a><a id="The-copy_to-interface-1"></a><a class="docs-heading-anchor-permalink" href="#The-copy_to-interface" title="Permalink"></a></h3><p>To implement the <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a> interface, implement the following function:</p><ul><li><a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a></li></ul><h3 id="The-incremental-interface"><a class="docs-heading-anchor" href="#The-incremental-interface">The incremental interface</a><a id="The-incremental-interface-1"></a><a class="docs-heading-anchor-permalink" href="#The-incremental-interface" title="Permalink"></a></h3><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Writing this interface is a lot of work. The easiest way is to consult the source code of a similar solver!</p></div></div><p>To implement the incremental interface, implement the following functions:</p><ul><li><a href="../../reference/variables/#MathOptInterface.add_variable"><code>add_variable</code></a></li><li><a href="../../reference/variables/#MathOptInterface.add_variables"><code>add_variables</code></a></li><li><a href="../../reference/constraints/#MathOptInterface.add_constraint"><code>add_constraint</code></a></li><li><a href="../../reference/constraints/#MathOptInterface.add_constraints"><code>add_constraints</code></a></li><li><a href="../../reference/constraints/#MathOptInterface.is_valid-Tuple{MathOptInterface.ModelLike, MathOptInterface.ConstraintIndex}"><code>is_valid</code></a></li><li><a href="../../reference/variables/#MathOptInterface.delete-Tuple{MathOptInterface.ModelLike, MathOptInterface.VariableIndex}"><code>delete</code></a></li></ul><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Solvers do not have to support <code>AbstractScalarFunction</code> in <code>GreaterThan</code>, <code>LessThan</code>, <code>EqualTo</code>, or <code>Interval</code> with a nonzero constant in the function. Throw <a href="../../reference/errors/#MathOptInterface.ScalarFunctionConstantNotZero"><code>ScalarFunctionConstantNotZero</code></a> if the function constant is not zero.</p></div></div><p>In addition, you should implement the following model attributes:</p><table><tr><th style="text-align: right">Attribute</th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.get"><code>get</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.set"><code>set</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a></th></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ListOfModelAttributesSet"><code>ListOfModelAttributesSet</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ObjectiveFunctionType"><code>ObjectiveFunctionType</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ObjectiveFunction"><code>ObjectiveFunction</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ObjectiveSense"><code>ObjectiveSense</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.Name"><code>Name</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr></table><p>Variable-related attributes:</p><table><tr><th style="text-align: right">Attribute</th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.get"><code>get</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.set"><code>set</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a></th></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ListOfVariableAttributesSet"><code>ListOfVariableAttributesSet</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.NumberOfVariables"><code>NumberOfVariables</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ListOfVariableIndices"><code>ListOfVariableIndices</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr></table><p>Constraint-related attributes:</p><table><tr><th style="text-align: right">Attribute</th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.get"><code>get</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.set"><code>set</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a></th></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ListOfConstraintAttributesSet"><code>ListOfConstraintAttributesSet</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.NumberOfConstraints"><code>NumberOfConstraints</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/models/#MathOptInterface.ListOfConstraintTypesPresent"><code>ListOfConstraintTypesPresent</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">No</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/constraints/#MathOptInterface.ConstraintFunction"><code>ConstraintFunction</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">No</td></tr><tr><td style="text-align: right"><a href="../../reference/constraints/#MathOptInterface.ConstraintSet"><code>ConstraintSet</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">No</td></tr></table><h4 id="Modifications"><a class="docs-heading-anchor" href="#Modifications">Modifications</a><a id="Modifications-1"></a><a class="docs-heading-anchor-permalink" href="#Modifications" title="Permalink"></a></h4><p>If your solver supports modifying data in-place, implement <a href="../../reference/modification/#MathOptInterface.modify"><code>modify</code></a> for the following <code>AbstractModification</code>s:</p><ul><li><a href="../../reference/modification/#MathOptInterface.ScalarConstantChange"><code>ScalarConstantChange</code></a></li><li><a href="../../reference/modification/#MathOptInterface.ScalarCoefficientChange"><code>ScalarCoefficientChange</code></a></li><li><a href="../../reference/modification/#MathOptInterface.VectorConstantChange"><code>VectorConstantChange</code></a></li><li><a href="../../reference/modification/#MathOptInterface.MultirowChange"><code>MultirowChange</code></a></li></ul><h4 id="Variables-constrained-on-creation"><a class="docs-heading-anchor" href="#Variables-constrained-on-creation">Variables constrained on creation</a><a id="Variables-constrained-on-creation-1"></a><a class="docs-heading-anchor-permalink" href="#Variables-constrained-on-creation" title="Permalink"></a></h4><p>Some solvers require variables be associated with a set <em>when they are created</em>. This conflicts with the incremental modification approach, since you cannot first add a free variable and then constrain it to the set.</p><p>If this is the case, implement:</p><ul><li><a href="../../reference/variables/#MathOptInterface.add_constrained_variable"><code>add_constrained_variable</code></a></li><li><a href="../../reference/variables/#MathOptInterface.add_constrained_variables"><code>add_constrained_variables</code></a></li><li><a href="../../reference/variables/#MathOptInterface.supports_add_constrained_variables"><code>supports_add_constrained_variables</code></a></li></ul><p>By default, MathOptInterface assumes solvers support free variables. If your solver does not support free variables, define:</p><pre><code class="language-julia hljs">MOI.supports_add_constrained_variables(::Optimizer, ::Type{Reals}) = false</code></pre><h3 id="Incremental-and-copy_to"><a class="docs-heading-anchor" href="#Incremental-and-copy_to">Incremental and <code>copy_to</code></a><a id="Incremental-and-copy_to-1"></a><a class="docs-heading-anchor-permalink" href="#Incremental-and-copy_to" title="Permalink"></a></h3><p>If you implement the incremental interface, you have the option of also implementing <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a>.</p><p>If you don&#39;t want to implement <a href="../../reference/models/#MathOptInterface.copy_to"><code>copy_to</code></a>, e.g., because the solver has no API for building the problem in a single function call, define the following fallback:</p><pre><code class="language-julia hljs">MOI.supports_incremental_interface(::Optimizer) = true

function MOI.copy_to(dest::Optimizer, src::MOI.ModelLike)
    return MOI.Utilities.default_copy_to(dest, src)
end</code></pre><h2 id="implement_names"><a class="docs-heading-anchor" href="#implement_names">Names</a><a id="implement_names-1"></a><a class="docs-heading-anchor-permalink" href="#implement_names" title="Permalink"></a></h2><p>Regardless of which interface you implement, you have the option of implementing the <code>Name</code> attribute for variables and constraints:</p><table><tr><th style="text-align: right">Attribute</th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.get"><code>get</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.set"><code>set</code></a></th><th style="text-align: right"><a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a></th></tr><tr><td style="text-align: right"><a href="../../reference/variables/#MathOptInterface.VariableName"><code>VariableName</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr><tr><td style="text-align: right"><a href="../../reference/constraints/#MathOptInterface.ConstraintName"><code>ConstraintName</code></a></td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td><td style="text-align: right">Yes</td></tr></table><p>If you implement names, you must also implement the following three methods:</p><pre><code class="language-julia hljs">function MOI.get(model::Optimizer, ::Type{MOI.VariableIndex}, name::String)
    return # The variable named `name`.
end

function MOI.get(model::Optimizer, ::Type{MOI.ConstraintIndex}, name::String)
    return # The constraint any type named `name`.
end

function MOI.get(
    model::Optimizer,
    ::Type{MOI.ConstraintIndex{F,S}},
    name::String,
) where {F,S}
    return # The constraint of type F-in-S named `name`.
end</code></pre><p>These methods have the following rules:</p><ul><li>If there is no variable or constraint with the name, return <code>nothing</code></li><li>If there is a single variable or constraint with that name, return the variable or constraint</li><li>If there are multiple variables or constraints with the name, throw an error.</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>You should <em>not</em> implement <a href="../../reference/constraints/#MathOptInterface.ConstraintName"><code>ConstraintName</code></a> for <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a> constraints. If you implement <a href="../../reference/constraints/#MathOptInterface.ConstraintName"><code>ConstraintName</code></a> for other constraints, you can add the following two methods to disable <a href="../../reference/constraints/#MathOptInterface.ConstraintName"><code>ConstraintName</code></a> for <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a> constraints.</p><pre><code class="language-julia hljs">function MOI.supports(
    ::Optimizer,
    ::MOI.ConstraintName,
    ::Type{&lt;:MOI.ConstraintIndex{MOI.VariableIndex,&lt;:MOI.AbstractScalarSet}},
)
    return throw(MOI.VariableIndexConstraintNameError())
end
function MOI.set(
    ::Optimizer,
    ::MOI.ConstraintName,
    ::MOI.ConstraintIndex{MOI.VariableIndex,&lt;:MOI.AbstractScalarSet},
    ::String,
)
    return throw(MOI.VariableIndexConstraintNameError())
end</code></pre></div></div><h2 id="Solutions"><a class="docs-heading-anchor" href="#Solutions">Solutions</a><a id="Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Solutions" title="Permalink"></a></h2><p>Implement <a href="../../reference/models/#MathOptInterface.optimize!"><code>optimize!</code></a> to solve the model:</p><ul><li><a href="../../reference/models/#MathOptInterface.optimize!"><code>optimize!</code></a></li></ul><p>All <code>Optimizer</code>s must implement the following attributes:</p><ul><li><a href="../../reference/models/#MathOptInterface.DualStatus"><code>DualStatus</code></a></li><li><a href="../../reference/models/#MathOptInterface.PrimalStatus"><code>PrimalStatus</code></a></li><li><a href="../../reference/models/#MathOptInterface.RawStatusString"><code>RawStatusString</code></a></li><li><a href="../../reference/models/#MathOptInterface.ResultCount"><code>ResultCount</code></a></li><li><a href="../../reference/models/#MathOptInterface.TerminationStatus"><code>TerminationStatus</code></a></li></ul><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>You only need to implement <a href="../../reference/models/#MathOptInterface.get"><code>get</code></a> for solution attributes. Don&#39;t implement <a href="../../reference/models/#MathOptInterface.set"><code>set</code></a> or <a href="../../reference/models/#MathOptInterface.supports"><code>supports</code></a>.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Solver wrappers should document how the low-level statuses map to the MOI statuses. Statuses like <code>NEARLY_FEASIBLE_POINT</code> and <code>INFEASIBLE_POINT</code>, are designed to be used when the solver explicitly indicates that relaxed tolerances are satisfied or the returned point is infeasible, respectively.</p></div></div><p>You should also implement the following attributes:</p><ul><li><a href="../../reference/models/#MathOptInterface.ObjectiveValue"><code>ObjectiveValue</code></a></li><li><a href="../../reference/models/#MathOptInterface.SolveTimeSec"><code>SolveTimeSec</code></a></li><li><a href="../../reference/variables/#MathOptInterface.VariablePrimal"><code>VariablePrimal</code></a></li></ul><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Attributes like <a href="../../reference/variables/#MathOptInterface.VariablePrimal"><code>VariablePrimal</code></a> and <a href="../../reference/models/#MathOptInterface.ObjectiveValue"><code>ObjectiveValue</code></a> are indexed by the result count. Use <code>MOI.check_result_index_bounds(model, attr)</code> to throw an error if the attribute is not available.</p></div></div><p>If your solver returns dual solutions, implement:</p><ul><li><a href="../../reference/constraints/#MathOptInterface.ConstraintDual"><code>ConstraintDual</code></a></li><li><a href="../../reference/models/#MathOptInterface.DualObjectiveValue"><code>DualObjectiveValue</code></a></li></ul><p>For integer solvers, implement:</p><ul><li><a href="../../reference/models/#MathOptInterface.ObjectiveBound"><code>ObjectiveBound</code></a></li><li><a href="../../reference/models/#MathOptInterface.RelativeGap"><code>RelativeGap</code></a></li></ul><p>If applicable, implement:</p><ul><li><a href="../../reference/models/#MathOptInterface.SimplexIterations"><code>SimplexIterations</code></a></li><li><a href="../../reference/models/#MathOptInterface.BarrierIterations"><code>BarrierIterations</code></a></li><li><a href="../../reference/models/#MathOptInterface.NodeCount"><code>NodeCount</code></a></li></ul><p>If your solver uses the Simplex method, implement:</p><ul><li><a href="../../reference/constraints/#MathOptInterface.ConstraintBasisStatus"><code>ConstraintBasisStatus</code></a></li></ul><p>If your solver accepts primal or dual warm-starts, implement:</p><ul><li><a href="../../reference/variables/#MathOptInterface.VariablePrimalStart"><code>VariablePrimalStart</code></a></li><li><a href="../../reference/constraints/#MathOptInterface.ConstraintDualStart"><code>ConstraintDualStart</code></a></li></ul><h2 id="Other-tips"><a class="docs-heading-anchor" href="#Other-tips">Other tips</a><a id="Other-tips-1"></a><a class="docs-heading-anchor-permalink" href="#Other-tips" title="Permalink"></a></h2><p>Here are some other points to be aware of when writing your wrapper.</p><h3 id="Unsupported-constraints-at-runtime"><a class="docs-heading-anchor" href="#Unsupported-constraints-at-runtime">Unsupported constraints at runtime</a><a id="Unsupported-constraints-at-runtime-1"></a><a class="docs-heading-anchor-permalink" href="#Unsupported-constraints-at-runtime" title="Permalink"></a></h3><p>In some cases, your solver may support a particular type of constraint (e.g., quadratic constraints), but only if the data meets some condition (e.g., it is convex).</p><p>In this case, declare that you <code>support</code> the constraint, and throw <a href="../../reference/errors/#MathOptInterface.AddConstraintNotAllowed"><code>AddConstraintNotAllowed</code></a>.</p><h3 id="Dealing-with-multiple-variable-bounds"><a class="docs-heading-anchor" href="#Dealing-with-multiple-variable-bounds">Dealing with multiple variable bounds</a><a id="Dealing-with-multiple-variable-bounds-1"></a><a class="docs-heading-anchor-permalink" href="#Dealing-with-multiple-variable-bounds" title="Permalink"></a></h3><p>MathOptInterface uses <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a> constraints to represent variable bounds. Defining multiple variable bounds on a single variable is not allowed.</p><p>Throw <a href="../../reference/errors/#MathOptInterface.LowerBoundAlreadySet"><code>LowerBoundAlreadySet</code></a> or <a href="../../reference/errors/#MathOptInterface.UpperBoundAlreadySet"><code>UpperBoundAlreadySet</code></a> if the user adds a constraint that results in multiple bounds.</p><p>Only throw if the constraints conflict. It is okay to add <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a>-in-<a href="../../reference/standard_form/#MathOptInterface.GreaterThan"><code>GreaterThan</code></a> and then <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a>-in-<a href="../../reference/standard_form/#MathOptInterface.LessThan"><code>LessThan</code></a>, but not <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a>-in-<a href="../../reference/standard_form/#MathOptInterface.Interval"><code>Interval</code></a> and then <a href="../../reference/standard_form/#MathOptInterface.VariableIndex"><code>VariableIndex</code></a>-in-<a href="../../reference/standard_form/#MathOptInterface.LessThan"><code>LessThan</code></a>,</p><h3 id="Expect-duplicate-coefficients"><a class="docs-heading-anchor" href="#Expect-duplicate-coefficients">Expect duplicate coefficients</a><a id="Expect-duplicate-coefficients-1"></a><a class="docs-heading-anchor-permalink" href="#Expect-duplicate-coefficients" title="Permalink"></a></h3><p>Solvers must expect that functions such as <a href="../../reference/standard_form/#MathOptInterface.ScalarAffineFunction"><code>ScalarAffineFunction</code></a> and <a href="../../reference/standard_form/#MathOptInterface.VectorQuadraticFunction"><code>VectorQuadraticFunction</code></a> may contain duplicate coefficents.</p><p>For example, <code>ScalarAffineFunction([ScalarAffineTerm(x, 1), ScalarAffineTerm(x, 1)], 0.0)</code>.</p><p>Use <a href="../../submodules/Utilities/reference/#MathOptInterface.Utilities.canonical"><code>Utilities.canonical</code></a> to return a new function with the duplicate coefficients aggregated together.</p><h3 id="Don&#39;t-modify-user-data"><a class="docs-heading-anchor" href="#Don&#39;t-modify-user-data">Don&#39;t modify user-data</a><a id="Don&#39;t-modify-user-data-1"></a><a class="docs-heading-anchor-permalink" href="#Don&#39;t-modify-user-data" title="Permalink"></a></h3><p>All data passed to the solver must be copied immediately to internal data structures. Solvers may not modify any input vectors and must assume that input vectors will not be modified by users in the future.</p><p>This applies, for example, to the <code>terms</code> vector in <a href="../../reference/standard_form/#MathOptInterface.ScalarAffineFunction"><code>ScalarAffineFunction</code></a>. Vectors returned to the user, e.g., via <a href="../../reference/models/#MathOptInterface.ObjectiveFunction"><code>ObjectiveFunction</code></a> or <a href="../../reference/constraints/#MathOptInterface.ConstraintFunction"><code>ConstraintFunction</code></a> attributes, must not be modified by the solver afterwards. The in-place version of <a href="../../reference/models/#MathOptInterface.get!"><code>get!</code></a> can be used by users to avoid extra copies in this case.</p><h3 id="Column-Generation"><a class="docs-heading-anchor" href="#Column-Generation">Column Generation</a><a id="Column-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Column-Generation" title="Permalink"></a></h3><p>There is no special interface for column generation. If the solver has a special API for setting coefficients in existing constraints when adding a new variable, it is possible to queue modifications and new variables and then call the solver&#39;s API once all of the new coefficients are known.</p><h3 id="Solver-specific-attributes"><a class="docs-heading-anchor" href="#Solver-specific-attributes">Solver-specific attributes</a><a id="Solver-specific-attributes-1"></a><a class="docs-heading-anchor-permalink" href="#Solver-specific-attributes" title="Permalink"></a></h3><p>You don&#39;t need to restrict yourself to the attributes defined in the MathOptInterface.jl package.</p><p>Solver-specific attributes should be specified by creating an appropriate subtype of <a href="../../reference/models/#MathOptInterface.AbstractModelAttribute"><code>AbstractModelAttribute</code></a>, <a href="../../reference/models/#MathOptInterface.AbstractOptimizerAttribute"><code>AbstractOptimizerAttribute</code></a>, <a href="../../reference/variables/#MathOptInterface.AbstractVariableAttribute"><code>AbstractVariableAttribute</code></a>, or <a href="../../reference/constraints/#MathOptInterface.AbstractConstraintAttribute"><code>AbstractConstraintAttribute</code></a>.</p><p>For example, Gurobi.jl adds attributes for multiobjective optimization by <a href="https://github.com/jump-dev/Gurobi.jl/blob/d9cebe4ec05a102df8917ff2602e6c38abdac090/src/MOI_multi_objective.jl#L1-L15">defining</a>:</p><pre><code class="language-julia hljs">struct NumberOfObjectives &lt;: MOI.AbstractModelAttribute end

function MOI.set(model::Optimizer, ::NumberOfObjectives, n::Integer)
    # Code to set NumberOfObjectives
    return
end

function MOI.get(model::Optimizer, ::NumberOfObjectives)
    n = # Code to get NumberOfObjectives
    return n
end</code></pre><p>Then, the user can write:</p><pre><code class="language-julia hljs">model = Gurobi.Optimizer()
MOI.set(model, Gurobi.NumberofObjectives(), 3)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example/">« Solving a problem using MathOptInterface</a><a class="docs-footer-nextpage" href="../mathprogbase/">Transitioning from MathProgBase »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Monday 22 August 2022 03:33">Monday 22 August 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
